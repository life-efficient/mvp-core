{"ast":null,"code":"var _jsxFileName = \"/home/ice/supermedia/webapp/src/adminComponents/SignUpUsers.js\";\nimport React, { Component } from 'react';\nimport { Redirect } from \"react-router-dom\";\nimport \"../components/SignUp.css\";\nimport { Auth } from \"aws-amplify\";\nimport posed from 'react-pose';\nimport { connect } from \"react-redux\";\nimport TelephoneInput from \"../general/form_components/TelephoneInput\";\nimport logo from \"../images/name.png\";\nimport \"../general/form_components/Forms.css\";\nimport { makePostRequest, makeGetRequest } from \"../api_calls\";\nimport Dropdown from \"../general/form_components/Dropdown\";\nconst Question = posed.div({\n  invalid: {\n    color: \"#ff0000\",\n    borderColor: \"#ff0000\"\n  },\n  valid: {\n    color: \"#000000\"\n  }\n});\n\nclass SignUp extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = () => {\n      window.analytics.page('Sign up user manually');\n    };\n\n    this.handleChange = event => {\n      var val = event.target.id;\n      var key = event.target.value;\n      this.setState({\n        [val]: key\n      });\n      console.log(this.state);\n    };\n\n    this.handleNumChange = (num, isValid) => {\n      this.setState({\n        phone_number: num,\n        num_is_valid: isValid\n      }, () => {//console.log('new num:', this.state.phone_number)\n        //console.log('is it valid?', this.state.num_is_valid)\n      });\n      console.log('----------');\n    };\n\n    this.handleOptionChange = event => {\n      this.setState({\n        [event.target.name]: event.target.value\n      }, () => {\n        console.log(this.state);\n      });\n    };\n\n    this.handleSubmit = event => {\n      alert('submitted: ' + this.state.value);\n      event.preventDefault();\n    };\n\n    this.nextPage = () => {\n      var part = this.state.page;\n\n      if (this.validate(part)) {\n        this.setState({\n          page: this.state.page + 1\n        });\n      } else {\n        console.log('pt1 invalid');\n      }\n    };\n\n    this.containsSomething = val => {\n      return val !== \"\";\n    };\n\n    this.updatePhoneNumberValidity = validInTelInputComponent => {\n      this.setState({\n        num_is_valid: validInTelInputComponent\n      });\n    };\n\n    this.isValidPhoneNumber = () => {\n      return this.state.num_is_valid;\n    };\n\n    this.validate = part => {\n      const checks = {\n        phone_number: [this.isValidPhoneNumber],\n        optional: ['instagram', 'age']\n      };\n      this.state.invalids = [];\n      var allValid = this.questions[part].map(keyName => {\n        console.log(keyName);\n        if (checks.optional.includes(keyName)) return true; // return true if this input is optional\n\n        var validation_functions = [this.containsSomething];\n\n        if (checks[keyName]) {\n          validation_functions.push(...checks[keyName]);\n        }\n\n        console.log('checking validity of', keyName, 'with functions:', validation_functions);\n        var valid = validation_functions.map(f => {\n          console.log(this.state[keyName]);\n          return f(this.state[keyName]);\n        });\n        valid = valid.every(item => item === true);\n\n        if (!valid) {\n          this.promptInvalidResponse(keyName);\n        }\n\n        console.log(keyName, 'valid?', valid);\n        return valid;\n      }).every(item => item == true);\n      console.log('all inputs on this page are valid?', allValid);\n      return allValid;\n    };\n\n    this.promptInvalidResponse = value => {\n      this.state.invalids.push(value);\n      window.analytics.track('sign up failed', {\n        inputs: this.state\n      });\n      this.setState({\n        invalids: this.state.invalids\n      }, function () {//console.log('invalid responses:', this.state.invalids);\n      });\n    };\n\n    this.invalidAnimation = value => {\n      var invalid = this.state.invalids.includes(value);\n      return invalid;\n    };\n\n    this.get = what => {\n      const state = this.state;\n\n      switch (what) {\n        case \"details\":\n          return {\n            name: state.name,\n            phone_number: state.phone_number,\n            location: state.location,\n            gender: state.gender,\n            acq_channel: state.acq_channel,\n            password: state.password,\n            instagram: state.instagram,\n            age: state.age\n          };\n\n        default:\n          break;\n      }\n    };\n\n    this.signUp = () => {\n      window.analytics.track('Submit signup button clicked');\n\n      if (this.validate(this.state.page)) {\n        this.nextPage();\n        console.log('submitting');\n        var phone_number = this.state.phone_number;\n        var password = this.makeid(8);\n        this.setState({\n          password: password\n        });\n        Auth.signUp(phone_number, password).then(() => {\n          console.log('Signing in');\n          Auth.signIn(phone_number, password).then(data => {\n            this.props.dispatchLogin();\n            console.log('Getting session');\n            console.log('cognito response after sign in:', data);\n            makePostRequest('make-request', this.state, () => {\n              console.log('request made');\n              this.props.setRequests();\n              window.analytics.track('User signed up');\n              window.analytics.track('Request made');\n            });\n          }, err => {\n            console.log('AN ERROR OCCURED WHILST SIGNING IN');\n            console.log(err);\n            this.handleErrors(err);\n          });\n        }, err => {\n          console.log('AN ERROR OCCURED WHILST SIGNING UP');\n          console.log(err);\n          this.handleErrors(err);\n        });\n      }\n    };\n\n    this.updateDetails = () => {\n      console.log(this.validate(this.state.page));\n\n      if (this.validate(this.state.page)) {\n        this.nextPage();\n        console.log('update details body:', this.get('details'));\n        makePostRequest('update-my-details', this.get('details'), () => {\n          console.log('details updated');\n        });\n      }\n    };\n\n    this.handleErrors = err => {\n      console.log('handling error:', err);\n      console.log('type:', err.code);\n\n      if (err.code === 'UsernameExistsException') {\n        console.log('user already exists');\n        this.setState({\n          redirect: true\n        });\n      }\n    };\n\n    this.state = {\n      name: '',\n      phone_number: '',\n      location: '',\n      gender: '',\n      acq_channel: '',\n      password: '',\n      request: '',\n      budget: '',\n      instagram: '',\n      age: '',\n      page: 1,\n      invalids: [],\n      num_is_valid: false\n    };\n    this.questions = {\n      1: [\"name\", \"request\", \"budget\", \"phone_number\"],\n      2: [\"location\", \"gender\", \"acq_channel\"],\n      3: [\"instagram\", \"age\"]\n    };\n  }\n\n  makeid(length) {\n    var text = \"\";\n    var possible = \"abcdefghijklmnopqrstuvwxyz0123456789\";\n\n    for (var i = 0; i < length; i++) {\n      text += possible.charAt(Math.floor(Math.random() * possible.length));\n    }\n\n    ;\n    return text;\n  }\n\n  render() {\n    if (this.state.redirect) {\n      console.log('rendering redirect');\n      return React.createElement(Redirect, {\n        to: \"/login\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      });\n    }\n\n    switch (this.state.page) {\n      case 1:\n        return React.createElement(\"div\", {\n          className: \"index-body body\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 263\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"panel small\",\n          id: \"part-1\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 264\n          },\n          __self: this\n        }, React.createElement(Question, {\n          className: \"question\",\n          pose: this.invalidAnimation('name') ? 'invalid' : 'valid',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 267\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"ask small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 268\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 269\n          },\n          __self: this\n        }, \"What can I call they?\")), React.createElement(\"input\", {\n          className: \"text-response\",\n          id: \"name\",\n          placeholder: \"Your name\",\n          onChange: this.handleChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 271\n          },\n          __self: this\n        })), React.createElement(Question, {\n          className: \"question\",\n          pose: this.invalidAnimation('request') ? 'invalid' : 'valid',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 275\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"ask small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 276\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 277\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 278\n          },\n          __self: this\n        }, \"What can I find for they?\"))), React.createElement(\"div\", {\n          className: \"subheading\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 281\n          },\n          __self: this\n        }, \"Be as specific as they like!\"), React.createElement(\"textarea\", {\n          className: \"text-response\",\n          id: \"request\",\n          placeholder: \"For example: 'I need a sparkly party dress that will go with my new heels'\",\n          onChange: this.handleChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 282\n          },\n          __self: this\n        })), React.createElement(Question, {\n          className: \"question\",\n          pose: this.invalidAnimation('budget') ? 'invalid' : 'valid',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 286\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"ask small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 287\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 288\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 289\n          },\n          __self: this\n        }, \"What's their rough budget?\"))), React.createElement(\"input\", {\n          className: \"text-response\",\n          id: \"budget\",\n          placeholder: \"I'm looking to spend around...\",\n          onChange: this.handleChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 292\n          },\n          __self: this\n        })), React.createElement(Question, {\n          className: \"question\",\n          pose: this.invalidAnimation('phone_number') ? 'invalid' : 'valid',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 296\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"ask small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 297\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 297\n          },\n          __self: this\n        }, \"What's their mobile number?\")), React.createElement(\"div\", {\n          className: \"small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 298\n          },\n          __self: this\n        }, \"I'll sort out their clothes much faster by messaging.\"), React.createElement(TelephoneInput, {\n          className: \"tel-input\",\n          onChange: this.handleNumChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 299\n          },\n          __self: this\n        }), React.createElement(\"button\", {\n          className: \"main_button btn\",\n          id: \"submit-1\",\n          onClick: this.signUp,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 300\n          },\n          __self: this\n        }, \"Talk to Adla!\"))));\n\n      case 2:\n        return React.createElement(\"div\", {\n          className: \"index-body body\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 310\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"panel\",\n          id: \"part-2\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 311\n          },\n          __self: this\n        }, React.createElement(Question, {\n          className: \"question\",\n          pose: this.invalidAnimation('gender') ? 'invalid' : 'valid',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 313\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"ask small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 314\n          },\n          __self: this\n        }, \"What gender do they identify with?\"), React.createElement(\"div\", {\n          className: \"single-choice-response\",\n          id: \"sex\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 316\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          id: \"female\",\n          className: \"radio_btn\",\n          type: \"radio\",\n          name: \"gender\",\n          value: \"female\",\n          onChange: this.handleOptionChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 317\n          },\n          __self: this\n        }), React.createElement(\"label\", {\n          htmlFor: \"female\",\n          className: \"quiz_option\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 318\n          },\n          __self: this\n        }, \"Female\"), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 319\n          },\n          __self: this\n        }), React.createElement(\"input\", {\n          id: \"male\",\n          className: \"radio_btn\",\n          type: \"radio\",\n          name: \"gender\",\n          value: \"male\",\n          onChange: this.handleOptionChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 320\n          },\n          __self: this\n        }), React.createElement(\"label\", {\n          htmlFor: \"male\",\n          className: \"quiz_option\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 321\n          },\n          __self: this\n        }, \"Male\"), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 322\n          },\n          __self: this\n        }), React.createElement(\"input\", {\n          id: \"other_gender\",\n          className: \"radio_btn\",\n          type: \"radio\",\n          name: \"gender\",\n          value: \"other\",\n          onChange: this.handleOptionChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 323\n          },\n          __self: this\n        }), React.createElement(\"label\", {\n          htmlFor: \"other_gender\",\n          className: \"quiz_option\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 324\n          },\n          __self: this\n        }, \"Other\"), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 325\n          },\n          __self: this\n        }))), React.createElement(Question, {\n          className: \"question\",\n          pose: this.invalidAnimation('location') ? 'invalid' : 'valid',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 330\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"ask small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 331\n          },\n          __self: this\n        }, \"What city are they in?\"), React.createElement(Dropdown, {\n          onChange: this.handleOptionChange,\n          id: \"location\",\n          value: this.state.location,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 332\n          },\n          __self: this\n        })), React.createElement(Question, {\n          className: \"question\",\n          pose: this.invalidAnimation('acq_channel') ? 'invalid' : 'valid',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 346\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"ask small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 347\n          },\n          __self: this\n        }, \"How did they hear about Adla?\"), React.createElement(\"div\", {\n          className: \"single-choice-response\",\n          id: \"found_Adla_through\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 348\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          id: \"instagram\",\n          className: \"radio_btn\",\n          type: \"radio\",\n          name: \"acq_channel\",\n          value: \"instagram\",\n          onChange: this.handleOptionChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 349\n          },\n          __self: this\n        }), React.createElement(\"label\", {\n          htmlFor: \"instagram\",\n          className: \"quiz_option\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 350\n          },\n          __self: this\n        }, \"Instagram\"), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 351\n          },\n          __self: this\n        }), React.createElement(\"input\", {\n          id: \"friend\",\n          className: \"radio_btn\",\n          type: \"radio\",\n          name: \"acq_channel\",\n          value: \"friend\",\n          onChange: this.handleOptionChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 352\n          },\n          __self: this\n        }), React.createElement(\"label\", {\n          htmlFor: \"friend\",\n          className: \"quiz_option\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 353\n          },\n          __self: this\n        }, \"Friends\"), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 354\n          },\n          __self: this\n        }), React.createElement(\"input\", {\n          className: \"text-response extra-detail not-required\",\n          name: \"acq_channel\",\n          id: \"custom-acq-channel\",\n          placeholder: \"Somewhere else?\",\n          onChange: this.handleOptionChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 355\n          },\n          __self: this\n        })), React.createElement(\"button\", {\n          className: \"main_button btn\",\n          id: \"submit-2\",\n          onClick: this.updateDetails,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 357\n          },\n          __self: this\n        }, this.state.loading ? React.createElement(\"img\", {\n          src: logo,\n          className: \"loading\",\n          alt: \"\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 359\n          },\n          __self: this\n        }) : \"Find those clothes!\"))));\n\n      case 3:\n        return React.createElement(\"div\", {\n          className: \"index-body body\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 368\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"panel\",\n          id: \"part-2\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 369\n          },\n          __self: this\n        }, React.createElement(Question, {\n          className: \"question\",\n          pose: this.invalidAnimation('instagram') ? 'invalid' : 'valid',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 371\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"ask small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 372\n          },\n          __self: this\n        }, \"What's their instagram handle?\"), React.createElement(\"input\", {\n          className: \"text-response\",\n          id: \"instagram\",\n          placeholder: \"@myinstagramhandle\",\n          onChange: this.handleChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 375\n          },\n          __self: this\n        })), React.createElement(Question, {\n          className: \"question\",\n          pose: this.invalidAnimation('age') ? 'invalid' : 'valid',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 379\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"ask small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 380\n          },\n          __self: this\n        }, \"What's their age?\"), React.createElement(\"input\", {\n          className: \"text-response\",\n          id: \"age\",\n          placeholder: \"My age is...\",\n          onChange: this.handleChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 381\n          },\n          __self: this\n        }), React.createElement(\"button\", {\n          className: \"main_button btn\",\n          id: \"submit-2\",\n          onClick: this.updateDetails,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 382\n          },\n          __self: this\n        }, this.state.loading ? React.createElement(\"img\", {\n          src: logo,\n          className: \"loading\",\n          alt: \"\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 384\n          },\n          __self: this\n        }) : \"Find those clothes!\"))));\n\n      default:\n        return React.createElement(Redirect, {\n          to: {\n            pathname: \"/5015db37-0d03-4f44-93a5-606ac215935b/admin\",\n            request: this.state.request\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 392\n          },\n          __self: this\n        });\n    }\n  }\n\n}\n\n;\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    dispatchLogin: () => {\n      dispatch({\n        type: \"LOG_IN\"\n      });\n    },\n    setRequests: () => {\n      makeGetRequest('get-my-requests', data => {\n        data = JSON.parse(data.body);\n        console.log(data);\n        dispatch({\n          type: \"SET_REQUESTS\",\n          requests: data\n        });\n      });\n    }\n  };\n};\n\nexport default SignUp = connect(null, mapDispatchToProps)(SignUp);","map":{"version":3,"sources":["/home/ice/supermedia/webapp/src/adminComponents/SignUpUsers.js"],"names":["React","Component","Redirect","Auth","posed","connect","TelephoneInput","logo","makePostRequest","makeGetRequest","Dropdown","Question","div","invalid","color","borderColor","valid","SignUp","constructor","props","componentDidMount","window","analytics","page","handleChange","event","val","target","id","key","value","setState","console","log","state","handleNumChange","num","isValid","phone_number","num_is_valid","handleOptionChange","name","handleSubmit","alert","preventDefault","nextPage","part","validate","containsSomething","updatePhoneNumberValidity","validInTelInputComponent","isValidPhoneNumber","checks","optional","invalids","allValid","questions","map","keyName","includes","validation_functions","push","f","every","item","promptInvalidResponse","track","inputs","invalidAnimation","get","what","location","gender","acq_channel","password","instagram","age","signUp","makeid","then","signIn","data","dispatchLogin","setRequests","err","handleErrors","updateDetails","code","redirect","request","budget","length","text","possible","i","charAt","Math","floor","random","render","loading","pathname","mapDispatchToProps","dispatch","type","JSON","parse","body","requests"],"mappings":";AACA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,QAAT,QAAyB,kBAAzB;AACA,OAAO,0BAAP;AACA,SAASC,IAAT,QAAqB,aAArB;AACA,OAAOC,KAAP,MAAkB,YAAlB;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,cAAP,MAA2B,2CAA3B;AACA,OAAOC,IAAP,MAAiB,oBAAjB;AACA,OAAO,sCAAP;AACA,SAASC,eAAT,EAA0BC,cAA1B,QAAgD,cAAhD;AACA,OAAOC,QAAP,MAAqB,qCAArB;AAEA,MAAMC,QAAQ,GAAGP,KAAK,CAACQ,GAAN,CAAU;AACvBC,EAAAA,OAAO,EAAE;AACLC,IAAAA,KAAK,EAAE,SADF;AAELC,IAAAA,WAAW,EAAE;AAFR,GADc;AAKvBC,EAAAA,KAAK,EAAE;AACHF,IAAAA,KAAK,EAAE;AADJ;AALgB,CAAV,CAAjB;;AAUA,MAAMG,MAAN,SAAqBhB,SAArB,CAA+B;AAE3BiB,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;;AADe,SAsCnBC,iBAtCmB,GAsCC,MAAM;AACtBC,MAAAA,MAAM,CAACC,SAAP,CAAiBC,IAAjB,CAAsB,uBAAtB;AACH,KAxCkB;;AAAA,SA0CnBC,YA1CmB,GA0CHC,KAAD,IAAW;AACtB,UAAIC,GAAG,GAAGD,KAAK,CAACE,MAAN,CAAaC,EAAvB;AACA,UAAIC,GAAG,GAAGJ,KAAK,CAACE,MAAN,CAAaG,KAAvB;AACA,WAAKC,QAAL,CAAc;AAAC,SAACL,GAAD,GAAOG;AAAR,OAAd;AACAG,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKC,KAAjB;AACH,KA/CkB;;AAAA,SAiDnBC,eAjDmB,GAiDD,CAACC,GAAD,EAAMC,OAAN,KAAkB;AAChC,WAAKN,QAAL,CAAc;AACVO,QAAAA,YAAY,EAAEF,GADJ;AAEVG,QAAAA,YAAY,EAAEF;AAFJ,OAAd,EAII,MAAM,CACF;AACA;AACH,OAPL;AASAL,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACH,KA5DkB;;AAAA,SA8DnBO,kBA9DmB,GA8DGf,KAAD,IAAW;AAC5B,WAAKM,QAAL,CAAc;AAAC,SAACN,KAAK,CAACE,MAAN,CAAac,IAAd,GAAqBhB,KAAK,CAACE,MAAN,CAAaG;AAAnC,OAAd,EACI,MAAM;AACFE,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAKC,KAAjB;AACH,OAHL;AAKH,KApEkB;;AAAA,SAsEnBQ,YAtEmB,GAsEHjB,KAAD,IAAW;AACtBkB,MAAAA,KAAK,CAAC,gBAAgB,KAAKT,KAAL,CAAWJ,KAA5B,CAAL;AACAL,MAAAA,KAAK,CAACmB,cAAN;AACH,KAzEkB;;AAAA,SA2EnBC,QA3EmB,GA2ER,MAAM;AACb,UAAIC,IAAI,GAAG,KAAKZ,KAAL,CAAWX,IAAtB;;AACA,UAAI,KAAKwB,QAAL,CAAcD,IAAd,CAAJ,EAAyB;AACrB,aAAKf,QAAL,CAAc;AAACR,UAAAA,IAAI,EAAE,KAAKW,KAAL,CAAWX,IAAX,GAAkB;AAAzB,SAAd;AACH,OAFD,MAGK;AACDS,QAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACH;AACJ,KAnFkB;;AAAA,SAqFnBe,iBArFmB,GAqFEtB,GAAD,IAAS;AACzB,aAAOA,GAAG,KAAK,EAAf;AACH,KAvFkB;;AAAA,SAyFnBuB,yBAzFmB,GAyFUC,wBAAD,IAA8B;AACtD,WAAKnB,QAAL,CAAc;AAACQ,QAAAA,YAAY,EAAEW;AAAf,OAAd;AACH,KA3FkB;;AAAA,SA6FnBC,kBA7FmB,GA6FE,MAAM;AACvB,aAAO,KAAKjB,KAAL,CAAWK,YAAlB;AACH,KA/FkB;;AAAA,SAiGnBQ,QAjGmB,GAiGPD,IAAD,IAAU;AACjB,YAAMM,MAAM,GAAG;AACXd,QAAAA,YAAY,EAAE,CAAC,KAAKa,kBAAN,CADH;AAEXE,QAAAA,QAAQ,EAAE,CAAC,WAAD,EAAc,KAAd;AAFC,OAAf;AAIA,WAAKnB,KAAL,CAAWoB,QAAX,GAAsB,EAAtB;AACA,UAAIC,QAAQ,GAAG,KAAKC,SAAL,CAAeV,IAAf,EAAqBW,GAArB,CACVC,OAAD,IAAa;AACT1B,QAAAA,OAAO,CAACC,GAAR,CAAYyB,OAAZ;AACA,YAAIN,MAAM,CAACC,QAAP,CAAgBM,QAAhB,CAAyBD,OAAzB,CAAJ,EAAuC,OAAO,IAAP,CAF9B,CAE+C;;AACxD,YAAIE,oBAAoB,GAAG,CAAC,KAAKZ,iBAAN,CAA3B;;AACA,YAAII,MAAM,CAACM,OAAD,CAAV,EAAqB;AAACE,UAAAA,oBAAoB,CAACC,IAArB,CAA0B,GAAGT,MAAM,CAACM,OAAD,CAAnC;AAA8C;;AACpE1B,QAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCyB,OAApC,EAA6C,iBAA7C,EAAgEE,oBAAhE;AACA,YAAI5C,KAAK,GAAG4C,oBAAoB,CAACH,GAArB,CACRK,CAAC,IAAI;AACD9B,UAAAA,OAAO,CAACC,GAAR,CAAY,KAAKC,KAAL,CAAWwB,OAAX,CAAZ;AACA,iBAAOI,CAAC,CAAC,KAAK5B,KAAL,CAAWwB,OAAX,CAAD,CAAR;AACH,SAJO,CAAZ;AAOA1C,QAAAA,KAAK,GAAGA,KAAK,CAAC+C,KAAN,CAAYC,IAAI,IAAIA,IAAI,KAAK,IAA7B,CAAR;;AACA,YAAI,CAAChD,KAAL,EAAY;AACR,eAAKiD,qBAAL,CAA2BP,OAA3B;AACH;;AACD1B,QAAAA,OAAO,CAACC,GAAR,CAAYyB,OAAZ,EAAqB,QAArB,EAA+B1C,KAA/B;AACA,eAAOA,KAAP;AACH,OApBU,EAqBb+C,KArBa,CAqBPC,IAAI,IAAIA,IAAI,IAAI,IArBT,CAAf;AAsBAhC,MAAAA,OAAO,CAACC,GAAR,CAAY,oCAAZ,EAAkDsB,QAAlD;AACA,aAAOA,QAAP;AACH,KA/HkB;;AAAA,SAiInBU,qBAjImB,GAiIMnC,KAAD,IAAW;AAC/B,WAAKI,KAAL,CAAWoB,QAAX,CAAoBO,IAApB,CAAyB/B,KAAzB;AACAT,MAAAA,MAAM,CAACC,SAAP,CAAiB4C,KAAjB,CAAuB,gBAAvB,EAAyC;AAACC,QAAAA,MAAM,EAAE,KAAKjC;AAAd,OAAzC;AACA,WAAKH,QAAL,CAAc;AAACuB,QAAAA,QAAQ,EAAE,KAAKpB,KAAL,CAAWoB;AAAtB,OAAd,EAA+C,YAAY,CACtD;AACJ,OAFD;AAGH,KAvIkB;;AAAA,SAyInBc,gBAzImB,GAyICtC,KAAD,IAAW;AAC1B,UAAIjB,OAAO,GAAG,KAAKqB,KAAL,CAAWoB,QAAX,CAAoBK,QAApB,CAA6B7B,KAA7B,CAAd;AACA,aAAOjB,OAAP;AACH,KA5IkB;;AAAA,SAuJnBwD,GAvJmB,GAuJZC,IAAD,IAAU;AACZ,YAAMpC,KAAK,GAAG,KAAKA,KAAnB;;AACA,cAAQoC,IAAR;AACI,aAAK,SAAL;AACI,iBAAO;AACH7B,YAAAA,IAAI,EAAEP,KAAK,CAACO,IADT;AAEHH,YAAAA,YAAY,EAAEJ,KAAK,CAACI,YAFjB;AAGHiC,YAAAA,QAAQ,EAAErC,KAAK,CAACqC,QAHb;AAIHC,YAAAA,MAAM,EAAEtC,KAAK,CAACsC,MAJX;AAKHC,YAAAA,WAAW,EAAEvC,KAAK,CAACuC,WALhB;AAMHC,YAAAA,QAAQ,EAAExC,KAAK,CAACwC,QANb;AAOHC,YAAAA,SAAS,EAAEzC,KAAK,CAACyC,SAPd;AAQHC,YAAAA,GAAG,EAAE1C,KAAK,CAAC0C;AARR,WAAP;;AAUJ;AACI;AAbR;AAgBH,KAzKkB;;AAAA,SA2KnBC,MA3KmB,GA2KV,MAAM;AACXxD,MAAAA,MAAM,CAACC,SAAP,CAAiB4C,KAAjB,CAAuB,8BAAvB;;AACA,UAAI,KAAKnB,QAAL,CAAc,KAAKb,KAAL,CAAWX,IAAzB,CAAJ,EAAoC;AAChC,aAAKsB,QAAL;AACAb,QAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACA,YAAIK,YAAY,GAAG,KAAKJ,KAAL,CAAWI,YAA9B;AACA,YAAIoC,QAAQ,GAAG,KAAKI,MAAL,CAAY,CAAZ,CAAf;AACA,aAAK/C,QAAL,CAAc;AACV2C,UAAAA,QAAQ,EAAEA;AADA,SAAd;AAGAvE,QAAAA,IAAI,CAAC0E,MAAL,CAAYvC,YAAZ,EAA0BoC,QAA1B,EACCK,IADD,CAEI,MAAM;AACF/C,UAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACA9B,UAAAA,IAAI,CAAC6E,MAAL,CAAY1C,YAAZ,EAA0BoC,QAA1B,EACCK,IADD,CAEIE,IAAI,IAAI;AACJ,iBAAK9D,KAAL,CAAW+D,aAAX;AACAlD,YAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AACAD,YAAAA,OAAO,CAACC,GAAR,CAAY,iCAAZ,EAA+CgD,IAA/C;AACAzE,YAAAA,eAAe,CAAC,cAAD,EAAiB,KAAK0B,KAAtB,EACP,MAAM;AACFF,cAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ;AACA,mBAAKd,KAAL,CAAWgE,WAAX;AACA9D,cAAAA,MAAM,CAACC,SAAP,CAAiB4C,KAAjB,CAAuB,gBAAvB;AACA7C,cAAAA,MAAM,CAACC,SAAP,CAAiB4C,KAAjB,CAAuB,cAAvB;AACH,aANM,CAAf;AAQH,WAdL,EAeIkB,GAAG,IAAI;AACHpD,YAAAA,OAAO,CAACC,GAAR,CAAY,oCAAZ;AACAD,YAAAA,OAAO,CAACC,GAAR,CAAYmD,GAAZ;AACA,iBAAKC,YAAL,CAAkBD,GAAlB;AACH,WAnBL;AAqBH,SAzBL,EA0BIA,GAAG,IAAI;AACHpD,UAAAA,OAAO,CAACC,GAAR,CAAY,oCAAZ;AACAD,UAAAA,OAAO,CAACC,GAAR,CAAYmD,GAAZ;AACA,eAAKC,YAAL,CAAkBD,GAAlB;AACH,SA9BL;AAgCH;AACJ,KAtNkB;;AAAA,SAwNnBE,aAxNmB,GAwNH,MAAM;AAClBtD,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKc,QAAL,CAAc,KAAKb,KAAL,CAAWX,IAAzB,CAAZ;;AACA,UAAI,KAAKwB,QAAL,CAAc,KAAKb,KAAL,CAAWX,IAAzB,CAAJ,EAAoC;AAChC,aAAKsB,QAAL;AACAb,QAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoC,KAAKoC,GAAL,CAAS,SAAT,CAApC;AACA7D,QAAAA,eAAe,CAAC,mBAAD,EAAsB,KAAK6D,GAAL,CAAS,SAAT,CAAtB,EACX,MAAM;AACFrC,UAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AACH,SAHU,CAAf;AAKH;AACJ,KAnOkB;;AAAA,SAmXnBoD,YAnXmB,GAmXHD,GAAD,IAAS;AACpBpD,MAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BmD,GAA/B;AACApD,MAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBmD,GAAG,CAACG,IAAzB;;AACA,UAAIH,GAAG,CAACG,IAAJ,KAAa,yBAAjB,EAA4C;AACxCvD,QAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ;AACA,aAAKF,QAAL,CAAc;AAACyD,UAAAA,QAAQ,EAAE;AAAX,SAAd;AACH;AACJ,KA1XkB;;AAGf,SAAKtD,KAAL,GAAa;AACTO,MAAAA,IAAI,EAAE,EADG;AAETH,MAAAA,YAAY,EAAE,EAFL;AAGTiC,MAAAA,QAAQ,EAAE,EAHD;AAITC,MAAAA,MAAM,EAAE,EAJC;AAKTC,MAAAA,WAAW,EAAE,EALJ;AAMTC,MAAAA,QAAQ,EAAE,EAND;AAOTe,MAAAA,OAAO,EAAE,EAPA;AAQTC,MAAAA,MAAM,EAAE,EARC;AASTf,MAAAA,SAAS,EAAE,EATF;AAUTC,MAAAA,GAAG,EAAE,EAVI;AAWTrD,MAAAA,IAAI,EAAE,CAXG;AAYT+B,MAAAA,QAAQ,EAAE,EAZD;AAaTf,MAAAA,YAAY,EAAE;AAbL,KAAb;AAgBA,SAAKiB,SAAL,GAAiB;AACb,SAAG,CACC,MADD,EAEC,SAFD,EAGC,QAHD,EAIC,cAJD,CADU;AAOb,SAAG,CACC,UADD,EAEC,QAFD,EAGC,aAHD,CAPU;AAYb,SAAG,CACC,WADD,EAEC,KAFD;AAZU,KAAjB;AAiBH;;AA0GDsB,EAAAA,MAAM,CAACa,MAAD,EAAS;AACX,QAAIC,IAAI,GAAG,EAAX;AACA,QAAIC,QAAQ,GAAG,sCAAf;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,MAApB,EAA4BG,CAAC,EAA7B,EAAiC;AAC7BF,MAAAA,IAAI,IAAIC,QAAQ,CAACE,MAAT,CAAgBC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgBL,QAAQ,CAACF,MAApC,CAAhB,CAAR;AACH;;AAAA;AACD,WAAOC,IAAP;AACH;;AAgFDO,EAAAA,MAAM,GAAG;AACL,QAAI,KAAKjE,KAAL,CAAWsD,QAAf,EAAyB;AACrBxD,MAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ;AACA,aAAO,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAC,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAP;AACH;;AACD,YAAQ,KAAKC,KAAL,CAAWX,IAAnB;AACI,WAAK,CAAL;AACI,eACI;AAAK,UAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAK,UAAA,SAAS,EAAC,aAAf;AAA6B,UAAA,EAAE,EAAC,QAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAGI,oBAAC,QAAD;AAAU,UAAA,SAAS,EAAC,UAApB;AAA+B,UAAA,IAAI,EAAE,KAAK6C,gBAAL,CAAsB,MAAtB,IAAgC,SAAhC,GAA4C,OAAjF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAK,UAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCADJ,CADJ,EAII;AAAO,UAAA,SAAS,EAAC,eAAjB;AAAiC,UAAA,EAAE,EAAC,MAApC;AAA2C,UAAA,WAAW,EAAC,WAAvD;AAAmE,UAAA,QAAQ,EAAE,KAAK5C,YAAlF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAJJ,CAHJ,EAWI,oBAAC,QAAD;AAAU,UAAA,SAAS,EAAC,UAApB;AAA+B,UAAA,IAAI,EAAE,KAAK4C,gBAAL,CAAsB,SAAtB,IAAmC,SAAnC,GAA+C,OAApF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAK,UAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uCADJ,CADJ,CADJ,EAMI;AAAK,UAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CANJ,EAOI;AAAU,UAAA,SAAS,EAAC,eAApB;AAAoC,UAAA,EAAE,EAAC,SAAvC;AAAiD,UAAA,WAAW,EAAC,4EAA7D;AAA0I,UAAA,QAAQ,EAAE,KAAK5C,YAAzJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAPJ,CAXJ,EAsBI,oBAAC,QAAD;AAAU,UAAA,SAAS,EAAC,UAApB;AAA+B,UAAA,IAAI,EAAE,KAAK4C,gBAAL,CAAsB,QAAtB,IAAkC,SAAlC,GAA8C,OAAnF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAK,UAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCADJ,CADJ,CADJ,EAMI;AAAO,UAAA,SAAS,EAAC,eAAjB;AAAiC,UAAA,EAAE,EAAC,QAApC;AAA6C,UAAA,WAAW,EAAC,gCAAzD;AAA0F,UAAA,QAAQ,EAAE,KAAK5C,YAAzG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UANJ,CAtBJ,EAgCI,oBAAC,QAAD;AAAU,UAAA,SAAS,EAAC,UAApB;AAA+B,UAAA,IAAI,EAAE,KAAK4C,gBAAL,CAAsB,cAAtB,IAAwC,SAAxC,GAAoD,OAAzF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAK,UAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAA2B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yCAA3B,CADJ,EAEI;AAAK,UAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mEAFJ,EAGI,oBAAC,cAAD;AAAgB,UAAA,SAAS,EAAC,WAA1B;AAAsC,UAAA,QAAQ,EAAE,KAAKjC,eAArD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAHJ,EAII;AAAQ,UAAA,SAAS,EAAC,iBAAlB;AAAoC,UAAA,EAAE,EAAC,UAAvC;AAAkD,UAAA,OAAO,EAAE,KAAK0C,MAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAJJ,CAhCJ,CADJ,CADJ;;AA8CJ,WAAK,CAAL;AACI,eACI;AAAK,UAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACA;AAAK,UAAA,SAAS,EAAC,OAAf;AAAuB,UAAA,EAAE,EAAC,QAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAEI,oBAAC,QAAD;AAAU,UAAA,SAAS,EAAC,UAApB;AAA+B,UAAA,IAAI,EAAE,KAAKT,gBAAL,CAAsB,QAAtB,IAAkC,SAAlC,GAA8C,OAAnF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAK,UAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gDADJ,EAGI;AAAK,UAAA,SAAS,EAAC,wBAAf;AAAwC,UAAA,EAAE,EAAC,KAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAO,UAAA,EAAE,EAAC,QAAV;AAAmB,UAAA,SAAS,EAAC,WAA7B;AAAyC,UAAA,IAAI,EAAC,OAA9C;AAAsD,UAAA,IAAI,EAAC,QAA3D;AAAoE,UAAA,KAAK,EAAC,QAA1E;AAAmF,UAAA,QAAQ,EAAE,KAAK5B,kBAAlG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ,EAEI;AAAO,UAAA,OAAO,EAAC,QAAf;AAAwB,UAAA,SAAS,EAAC,aAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFJ,EAGI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAHJ,EAII;AAAO,UAAA,EAAE,EAAC,MAAV;AAAiB,UAAA,SAAS,EAAC,WAA3B;AAAuC,UAAA,IAAI,EAAC,OAA5C;AAAoD,UAAA,IAAI,EAAC,QAAzD;AAAkE,UAAA,KAAK,EAAC,MAAxE;AAA+E,UAAA,QAAQ,EAAE,KAAKA,kBAA9F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAJJ,EAKI;AAAO,UAAA,OAAO,EAAC,MAAf;AAAsB,UAAA,SAAS,EAAC,aAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBALJ,EAMI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UANJ,EAOI;AAAO,UAAA,EAAE,EAAC,cAAV;AAAyB,UAAA,SAAS,EAAC,WAAnC;AAA+C,UAAA,IAAI,EAAC,OAApD;AAA4D,UAAA,IAAI,EAAC,QAAjE;AAA0E,UAAA,KAAK,EAAC,OAAhF;AAAwF,UAAA,QAAQ,EAAE,KAAKA,kBAAvG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAPJ,EAQI;AAAO,UAAA,OAAO,EAAC,cAAf;AAA8B,UAAA,SAAS,EAAC,aAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBARJ,EASI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UATJ,CAHJ,CAFJ,EAmBI,oBAAC,QAAD;AAAU,UAAA,SAAS,EAAC,UAApB;AAA+B,UAAA,IAAI,EAAE,KAAK4B,gBAAL,CAAsB,UAAtB,IAAoC,SAApC,GAAgD,OAArF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAK,UAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCADJ,EAEI,oBAAC,QAAD;AAAU,UAAA,QAAQ,EAAE,KAAK5B,kBAAzB;AAA6C,UAAA,EAAE,EAAC,UAAhD;AAA2D,UAAA,KAAK,EAAE,KAAKN,KAAL,CAAWqC,QAA7E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAFJ,CAnBJ,EAmCI,oBAAC,QAAD;AAAU,UAAA,SAAS,EAAC,UAApB;AAA+B,UAAA,IAAI,EAAE,KAAKH,gBAAL,CAAsB,aAAtB,IAAuC,SAAvC,GAAmD,OAAxF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAK,UAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CADJ,EAEI;AAAK,UAAA,SAAS,EAAC,wBAAf;AAAwC,UAAA,EAAE,EAAC,oBAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAO,UAAA,EAAE,EAAC,WAAV;AAAsB,UAAA,SAAS,EAAC,WAAhC;AAA4C,UAAA,IAAI,EAAC,OAAjD;AAAyD,UAAA,IAAI,EAAC,aAA9D;AAA4E,UAAA,KAAK,EAAC,WAAlF;AAA8F,UAAA,QAAQ,EAAE,KAAK5B,kBAA7G;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ,EAEI;AAAO,UAAA,OAAO,EAAC,WAAf;AAA2B,UAAA,SAAS,EAAC,aAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAFJ,EAGI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAHJ,EAII;AAAO,UAAA,EAAE,EAAC,QAAV;AAAmB,UAAA,SAAS,EAAC,WAA7B;AAAyC,UAAA,IAAI,EAAC,OAA9C;AAAsD,UAAA,IAAI,EAAC,aAA3D;AAAyE,UAAA,KAAK,EAAC,QAA/E;AAAwF,UAAA,QAAQ,EAAE,KAAKA,kBAAvG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAJJ,EAKI;AAAO,UAAA,OAAO,EAAC,QAAf;AAAwB,UAAA,SAAS,EAAC,aAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBALJ,EAMI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UANJ,EAOA;AAAO,UAAA,SAAS,EAAC,yCAAjB;AAA2D,UAAA,IAAI,EAAC,aAAhE;AAA8E,UAAA,EAAE,EAAC,oBAAjF;AAAsG,UAAA,WAAW,EAAC,iBAAlH;AAAoI,UAAA,QAAQ,EAAE,KAAKA,kBAAnJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAPA,CAFJ,EAWI;AAAQ,UAAA,SAAS,EAAC,iBAAlB;AAAoC,UAAA,EAAE,EAAC,UAAvC;AAAkD,UAAA,OAAO,EAAE,KAAK8C,aAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACK,KAAKpD,KAAL,CAAWkE,OAAX,GACD;AAAK,UAAA,GAAG,EAAE7F,IAAV;AAAgB,UAAA,SAAS,EAAC,SAA1B;AAAoC,UAAA,GAAG,EAAC,EAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADC,GAED,qBAHJ,CAXJ,CAnCJ,CADA,CADJ;;AAyDJ,WAAK,CAAL;AACI,eACI;AAAK,UAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAK,UAAA,SAAS,EAAC,OAAf;AAAuB,UAAA,EAAE,EAAC,QAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAEI,oBAAC,QAAD;AAAU,UAAA,SAAS,EAAC,UAApB;AAA+B,UAAA,IAAI,EAAE,KAAK6D,gBAAL,CAAsB,WAAtB,IAAqC,SAArC,GAAiD,OAAtF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAK,UAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4CADJ,EAII;AAAO,UAAA,SAAS,EAAC,eAAjB;AAAiC,UAAA,EAAE,EAAC,WAApC;AAAgD,UAAA,WAAW,EAAC,oBAA5D;AAAiF,UAAA,QAAQ,EAAE,KAAK5C,YAAhG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAJJ,CAFJ,EAUI,oBAAC,QAAD;AAAU,UAAA,SAAS,EAAC,UAApB;AAA+B,UAAA,IAAI,EAAE,KAAK4C,gBAAL,CAAsB,KAAtB,IAA+B,SAA/B,GAA2C,OAAhF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAK,UAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BADJ,EAEI;AAAO,UAAA,SAAS,EAAC,eAAjB;AAAiC,UAAA,EAAE,EAAC,KAApC;AAA0C,UAAA,WAAW,EAAC,cAAtD;AAAqE,UAAA,QAAQ,EAAE,KAAK5C,YAApF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAFJ,EAGA;AAAQ,UAAA,SAAS,EAAC,iBAAlB;AAAoC,UAAA,EAAE,EAAC,UAAvC;AAAkD,UAAA,OAAO,EAAE,KAAK8D,aAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACK,KAAKpD,KAAL,CAAWkE,OAAX,GACD;AAAK,UAAA,GAAG,EAAE7F,IAAV;AAAgB,UAAA,SAAS,EAAC,SAA1B;AAAoC,UAAA,GAAG,EAAC,EAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADC,GAED,qBAHJ,CAHA,CAVJ,CADJ,CADJ;;AAwBJ;AACI,eAAO,oBAAC,QAAD;AAAU,UAAA,EAAE,EAAE;AAAC8F,YAAAA,QAAQ,EAAE,6CAAX;AAA0DZ,YAAAA,OAAO,EAAE,KAAKvD,KAAL,CAAWuD;AAA9E,WAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AApIR;AAuIH;;AAnX0B;;AA6X9B;;AAED,MAAMa,kBAAkB,GAAIC,QAAD,IAAc;AACrC,SAAO;AACHrB,IAAAA,aAAa,EAAE,MAAM;AACjBqB,MAAAA,QAAQ,CAAC;AACLC,QAAAA,IAAI,EAAE;AADD,OAAD,CAAR;AAGH,KALE;AAMHrB,IAAAA,WAAW,EAAE,MAAM;AACd1E,MAAAA,cAAc,CAAC,iBAAD,EAAoBwE,IAAI,IAAI;AACvCA,QAAAA,IAAI,GAAGwB,IAAI,CAACC,KAAL,CAAWzB,IAAI,CAAC0B,IAAhB,CAAP;AACA3E,QAAAA,OAAO,CAACC,GAAR,CAAYgD,IAAZ;AACAsB,QAAAA,QAAQ,CAAC;AAACC,UAAAA,IAAI,EAAE,cAAP;AAAuBI,UAAAA,QAAQ,EAAE3B;AAAjC,SAAD,CAAR;AACH,OAJc,CAAd;AAKJ;AAZE,GAAP;AAcH,CAfD;;AAiBA,eAAehE,MAAM,GAAGZ,OAAO,CAAC,IAAD,EAAOiG,kBAAP,CAAP,CAAkCrF,MAAlC,CAAxB","sourcesContent":["\nimport React, { Component } from 'react'\nimport { Redirect } from \"react-router-dom\"\nimport \"../components/SignUp.css\"\nimport { Auth } from \"aws-amplify\"\nimport posed from 'react-pose';\nimport { connect } from \"react-redux\";\nimport TelephoneInput from \"../general/form_components/TelephoneInput\"\nimport logo from \"../images/name.png\";\nimport \"../general/form_components/Forms.css\"\nimport { makePostRequest, makeGetRequest } from \"../api_calls\"\nimport Dropdown from \"../general/form_components/Dropdown\"\n\nconst Question = posed.div({\n    invalid: { \n        color: \"#ff0000\",\n        borderColor: \"#ff0000\"\n    },\n    valid: { \n        color: \"#000000\" \n    }\n});\n\nclass SignUp extends Component {\n\n    constructor(props) {\n        super(props);\n        \n        this.state = {\n            name: '',\n            phone_number: '',\n            location: '',\n            gender: '',\n            acq_channel: '',\n            password: '',\n            request: '',\n            budget: '',\n            instagram: '',\n            age: '',\n            page: 1,\n            invalids: [],\n            num_is_valid: false\n        }\n\n        this.questions = {\n            1: [\n                \"name\",\n                \"request\",\n                \"budget\",\n                \"phone_number\"\n            ],\n            2: [\n                \"location\",\n                \"gender\",\n                \"acq_channel\"\n            ],\n            3: [\n                \"instagram\",\n                \"age\"\n            ]\n        }\n    }\n    \n    componentDidMount = () => {\n        window.analytics.page('Sign up user manually')\n    }\n\n    handleChange = (event) => {\n        var val = event.target.id\n        var key = event.target.value\n        this.setState({[val]: key});\n        console.log(this.state)\n    }\n\n    handleNumChange = (num, isValid) => {\n        this.setState({\n            phone_number: num,\n            num_is_valid: isValid\n        },\n            () => {\n                //console.log('new num:', this.state.phone_number)\n                //console.log('is it valid?', this.state.num_is_valid)\n            }\n        )\n        console.log('----------')\n    }\n\n    handleOptionChange = (event) => {\n        this.setState({[event.target.name]: event.target.value},\n            () => {\n                console.log(this.state)\n            }\n        )\n    }\n\n    handleSubmit = (event) => {\n        alert('submitted: ' + this.state.value)\n        event.preventDefault()\n    }\n\n    nextPage = () => {\n        var part = this.state.page\n        if (this.validate(part)) {\n            this.setState({page: this.state.page + 1})\n        }\n        else {\n            console.log('pt1 invalid')\n        }\n    }\n\n    containsSomething = (val) => {\n        return val !== \"\"\n    }\n\n    updatePhoneNumberValidity = (validInTelInputComponent) => {\n        this.setState({num_is_valid: validInTelInputComponent})\n    }\n\n    isValidPhoneNumber = () => {\n        return this.state.num_is_valid\n    }\n\n    validate = (part) => {\n        const checks = {\n            phone_number: [this.isValidPhoneNumber],\n            optional: ['instagram', 'age']\n        }\n        this.state.invalids = []\n        var allValid = this.questions[part].map(\n            (keyName) => {\n                console.log(keyName)\n                if (checks.optional.includes(keyName)) return true;     // return true if this input is optional\n                var validation_functions = [this.containsSomething]\n                if (checks[keyName]) {validation_functions.push(...checks[keyName])}\n                console.log('checking validity of', keyName, 'with functions:', validation_functions)\n                var valid = validation_functions.map(\n                    f => {\n                        console.log(this.state[keyName])\n                        return f(this.state[keyName])\n                    }\n                )\n\n                valid = valid.every(item => item === true)\n                if (!valid) {\n                    this.promptInvalidResponse(keyName)\n                }\n                console.log(keyName, 'valid?', valid)\n                return valid\n            }\n        ).every(item => item == true)\n        console.log('all inputs on this page are valid?', allValid)\n        return allValid\n    }\n\n    promptInvalidResponse = (value) => {\n        this.state.invalids.push(value)\n        window.analytics.track('sign up failed', {inputs: this.state})\n        this.setState({invalids: this.state.invalids}, function () {\n             //console.log('invalid responses:', this.state.invalids);\n        })\n    }\n\n    invalidAnimation = (value) => {\n        var invalid = this.state.invalids.includes(value)\n        return invalid\n    }\n\n    makeid(length) {\n        var text = \"\";\n        var possible = \"abcdefghijklmnopqrstuvwxyz0123456789\";\n        for (var i = 0; i < length; i++) {\n            text += possible.charAt(Math.floor(Math.random() * possible.length))\n        };\n        return text;\n    }\n\n    get = (what) => {\n        const state = this.state\n        switch (what) {\n            case \"details\":\n                return {\n                    name: state.name,\n                    phone_number: state.phone_number,\n                    location: state.location,\n                    gender: state.gender,\n                    acq_channel: state.acq_channel,\n                    password: state.password,\n                    instagram: state.instagram,\n                    age: state.age\n                }\n            default:\n                break\n        }\n\n    }\n\n    signUp = () => {\n        window.analytics.track('Submit signup button clicked')\n        if (this.validate(this.state.page)) {\n            this.nextPage()\n            console.log('submitting')\n            var phone_number = this.state.phone_number\n            var password = this.makeid(8)\n            this.setState({\n                password: password\n            })\n            Auth.signUp(phone_number, password)\n            .then(\n                () => {\n                    console.log('Signing in')\n                    Auth.signIn(phone_number, password)\n                    .then(\n                        data => {\n                            this.props.dispatchLogin()\n                            console.log('Getting session')\n                            console.log('cognito response after sign in:', data)\n                            makePostRequest('make-request', this.state,\n                                    () => {\n                                        console.log('request made')\n                                        this.props.setRequests()\n                                        window.analytics.track('User signed up')\n                                        window.analytics.track('Request made')\n                                    }\n                                )\n                        },\n                        err => {\n                            console.log('AN ERROR OCCURED WHILST SIGNING IN')\n                            console.log(err)\n                            this.handleErrors(err)\n                        }\n                    )\n                },\n                err => {\n                    console.log('AN ERROR OCCURED WHILST SIGNING UP')\n                    console.log(err)\n                    this.handleErrors(err)\n                }\n            )\n        }\n    };\n\n    updateDetails = () => {\n        console.log(this.validate(this.state.page))\n        if (this.validate(this.state.page)) {\n            this.nextPage()\n            console.log('update details body:', this.get('details'))\n            makePostRequest('update-my-details', this.get('details'), \n                () => {\n                    console.log('details updated')\n                }\n            )\n        }\n    }\n\n    render() {\n        if (this.state.redirect) {\n            console.log('rendering redirect')\n            return <Redirect to=\"/login\" />\n        }\n        switch (this.state.page) {\n            case 1:\n                return (\n                    <div className=\"index-body body\">\n                        <div className=\"panel small\" id=\"part-1\">\n            \n                            {/* NAME */}\n                            <Question className=\"question\" pose={this.invalidAnimation('name') ? 'invalid' : 'valid'} >\n                                <div className=\"ask small\">\n                                    <strong>What can I call they?</strong>\n                                </div>\n                                <input className=\"text-response\" id=\"name\" placeholder=\"Your name\" onChange={this.handleChange} />\n                            </Question>\n                        \n                            {/* REQUEST */}\n                            <Question className=\"question\" pose={this.invalidAnimation('request') ? 'invalid' : 'valid'} >\n                                <div className=\"ask small\">\n                                    <div>\n                                        <strong>What can I find for they?</strong>\n                                    </div>\n                                </div>\n                                <div className=\"subheading\">Be as specific as they like!</div>\n                                <textarea className=\"text-response\" id=\"request\" placeholder=\"For example: 'I need a sparkly party dress that will go with my new heels'\" onChange={this.handleChange} ></textarea>\n                            </Question>\n                        \n                            {/* BUDGET */}\n                            <Question className=\"question\" pose={this.invalidAnimation('budget') ? 'invalid' : 'valid'} >\n                                <div className=\"ask small\">\n                                    <div>\n                                        <strong>What's their rough budget?</strong>\n                                    </div>\n                                </div>\n                                <input className=\"text-response\" id=\"budget\" placeholder=\"I'm looking to spend around...\" onChange={this.handleChange} />\n                            </Question>\n                        \n                            {/* NUMBER */}\n                            <Question className=\"question\" pose={this.invalidAnimation('phone_number') ? 'invalid' : 'valid'} >\n                                <div className=\"ask small\"><strong>What's their mobile number?</strong></div>\n                                <div className=\"small\">I'll sort out their clothes much faster by messaging.</div>\n                                <TelephoneInput className=\"tel-input\" onChange={this.handleNumChange}/>\n                                <button className=\"main_button btn\" id=\"submit-1\" onClick={this.signUp}>\n                                        Talk to Adla!\n                                </button>\n                            </Question>\n                    \n                        </div>\n                    </div>\n                )\n            case 2:\n                return (\n                    <div className=\"index-body body\">\n                    <div className=\"panel\" id=\"part-2\">\n                        {/* GENDER */}\n                        <Question className=\"question\" pose={this.invalidAnimation('gender') ? 'invalid' : 'valid'} >\n                            <div className=\"ask small\">What gender do they identify with?</div>\n                        \n                            <div className=\"single-choice-response\" id=\"sex\">\n                                <input id=\"female\" className=\"radio_btn\" type=\"radio\" name=\"gender\" value=\"female\" onChange={this.handleOptionChange}/>\n                                <label htmlFor=\"female\" className=\"quiz_option\">Female</label>\n                                <br />\n                                <input id=\"male\" className=\"radio_btn\" type=\"radio\" name=\"gender\" value=\"male\" onChange={this.handleOptionChange}/>\n                                <label htmlFor=\"male\" className=\"quiz_option\">Male</label>\n                                <br />\n                                <input id=\"other_gender\" className=\"radio_btn\" type=\"radio\" name=\"gender\" value=\"other\" onChange={this.handleOptionChange}/>\n                                <label htmlFor=\"other_gender\" className=\"quiz_option\">Other</label>\n                                <br />\n                            </div>\n                        </Question>\n                        \n                        {/* LOCATION */}\n                        <Question className=\"question\" pose={this.invalidAnimation('location') ? 'invalid' : 'valid'} >\n                            <div className=\"ask small\">What city are they in?</div>\n                            <Dropdown onChange={this.handleOptionChange} id=\"location\" value={this.state.location}/>\n                            {/*\n                            <div className=\"single-choice-response\" id=\"location\">\n                                <input id=\"London\" className=\"radio_btn\" type=\"radio\" name=\"location\" value=\"london\" onChange={this.handleOptionChange}/>\n                                <label htmlFor=\"London\" className=\"quiz_option\"> Yes</label>\n                                <br />\n                                <input id=\"not_London\" className=\"radio_btn\" type=\"radio\" name=\"location\" value=\"not_london\" onChange={this.handleOptionChange}/>\n                                <label htmlFor=\"not_London\" className=\"quiz_option\"> No</label>\n                                <br />\n                            </div>\n                            */}\n                        </Question>\n                        \n                        {/* ACQ CHANNEL */}\n                        <Question className=\"question\" pose={this.invalidAnimation('acq_channel') ? 'invalid' : 'valid'} >\n                            <div className=\"ask small\">How did they hear about Adla?</div>\n                            <div className=\"single-choice-response\" id=\"found_Adla_through\">\n                                <input id=\"instagram\" className=\"radio_btn\" type=\"radio\" name=\"acq_channel\" value=\"instagram\" onChange={this.handleOptionChange}/>\n                                <label htmlFor=\"instagram\" className=\"quiz_option\">Instagram</label>\n                                <br />\n                                <input id=\"friend\" className=\"radio_btn\" type=\"radio\" name=\"acq_channel\" value=\"friend\" onChange={this.handleOptionChange}/>\n                                <label htmlFor=\"friend\" className=\"quiz_option\">Friends</label>\n                                <br />\n                            <input className=\"text-response extra-detail not-required\" name=\"acq_channel\" id=\"custom-acq-channel\" placeholder=\"Somewhere else?\" onChange={this.handleOptionChange}/>\n                            </div>\n                            <button className=\"main_button btn\" id=\"submit-2\" onClick={this.updateDetails}>\n                                {this.state.loading ? \n                                <img src={logo} className=\"loading\" alt=\"\"/>:\n                                \"Find those clothes!\"}\n                            </button>\n                        </Question>\n                    </div>\n                    </div>\n                )\n            case 3:\n                return (\n                    <div className=\"index-body body\">\n                        <div className=\"panel\" id=\"part-2\">\n                            {/* INSTAGRAM */}\n                            <Question className=\"question\" pose={this.invalidAnimation('instagram') ? 'invalid' : 'valid'} >\n                                <div className=\"ask small\">\n                                    What's their instagram handle?\n                                </div>\n                                <input className=\"text-response\" id=\"instagram\" placeholder=\"@myinstagramhandle\" onChange={this.handleChange} />\n                            </Question>\n                            \n                            {/* AGE */}\n                            <Question className=\"question\" pose={this.invalidAnimation('age') ? 'invalid' : 'valid'} >\n                                <div className=\"ask small\">What's their age?</div>\n                                <input className=\"text-response\" id=\"age\" placeholder=\"My age is...\" onChange={this.handleChange} />\n                            <button className=\"main_button btn\" id=\"submit-2\" onClick={this.updateDetails}>\n                                {this.state.loading ? \n                                <img src={logo} className=\"loading\" alt=\"\"/>:\n                                \"Find those clothes!\"}\n                            </button>\n                            </Question>\n                        </div>\n                    </div>\n                )\n            default:\n                return <Redirect to={{pathname: \"/5015db37-0d03-4f44-93a5-606ac215935b/admin\", request: this.state.request}}/>\n        }\n        \n    }\n\n    handleErrors = (err) => {\n        console.log('handling error:', err)\n        console.log('type:', err.code)\n        if (err.code === 'UsernameExistsException') {\n            console.log('user already exists')\n            this.setState({redirect: true})\n        }\n    }\n};\n\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        dispatchLogin: () => {\n            dispatch({\n                type: \"LOG_IN\"\n            })\n        },\n        setRequests: () => {\n             makeGetRequest('get-my-requests', data => {\n                data = JSON.parse(data.body)\n                console.log(data)\n                dispatch({type: \"SET_REQUESTS\", requests: data})\n            })\n        }\n    }\n}\n\nexport default SignUp = connect(null, mapDispatchToProps)(SignUp)"]},"metadata":{},"sourceType":"module"}