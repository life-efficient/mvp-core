{"ast":null,"code":"import _defineProperty from \"/home/ice/test/test/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/ice/test/test/src/stylistComponents/Messaging.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from \"react\";\nimport send from \"../images/icons/send.svg\";\nimport \"./Messaging.css\";\nimport { makeGetRequest, makePostRequest } from \"../api_calls\";\nimport { Storage } from \"aws-amplify\";\nimport queryString from \"query-string\";\n\nclass Messaging extends Component {\n  constructor(props) {\n    super(props);\n\n    this.update = () => {\n      console.log('GETTING CHAT');\n      makeGetRequest(\"admin-chat?user_id=\".concat(this.user_id), data => {\n        console.log(data);\n        data = data.chats;\n        data = data.map(msg => {\n          console.log('MSG:', msg);\n\n          if (msg.sender == null) {\n            return null;\n          } else {\n            return React.createElement(\"div\", {\n              className: msg.sender == 'us' ? 'msg adla' : 'msg',\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 45\n              },\n              __self: this\n            }, msg.body, msg.our_instagram_media_url ? React.createElement(\"img\", {\n              src: msg.our_instagram_media_url,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 49\n              },\n              __self: this\n            }) : null);\n          }\n        });\n        this.setState({\n          msgs: data\n        });\n      });\n    };\n\n    this.handleBodyChange = e => {\n      this.setState({\n        payload: _objectSpread({}, this.state.payload, {\n          body: e.target.value\n        })\n      }, () => {// console.log(this.state.payload.body)\n      });\n    };\n\n    this.sendMessage = () => {\n      console.log('SENDING:', this.state.payload);\n      makePostRequest(\"admin-chat?user_id=\".concat(this.user_id), this.state.payload, () => {\n        console.log('message sent');\n      });\n      this.setState({\n        payload: _objectSpread({}, this.state.payload, {\n          body: ''\n        })\n      });\n    };\n\n    var params = queryString.parse(window.location.search);\n    this.user_id = props.user_id ? props.user_id : params.sub;\n    this.update();\n    this.state = {\n      msgs: null,\n      payload: {\n        body: '',\n        type: 'text'\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.interval = setInterval(this.update, 600000);\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.interval);\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"panel\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"medium\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, \"Adla's chat with them\"), React.createElement(\"div\", {\n      id: \"chat\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"msgs\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, this.state.msgs)), React.createElement(\"div\", {\n      id: \"msg_prompts\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default Messaging;","map":{"version":3,"sources":["/home/ice/test/test/src/stylistComponents/Messaging.js"],"names":["React","Component","makeGetRequest","makePostRequest","Storage","queryString","Messaging","constructor","props","update","console","log","user_id","data","chats","map","msg","sender","body","our_instagram_media_url","setState","msgs","handleBodyChange","e","payload","state","target","value","sendMessage","params","parse","window","location","search","sub","type","componentDidMount","interval","setInterval","componentWillUnmount","clearInterval","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\"\nimport send from \"../images/icons/send.svg\"\nimport \"./Messaging.css\"\nimport { makeGetRequest, makePostRequest } from \"../api_calls\"\nimport { Storage } from \"aws-amplify\" \nimport queryString from \"query-string\"\n\nclass Messaging extends Component {\n    constructor(props) {\n        super(props)\n        var params = queryString.parse(window.location.search)\n        this.user_id = props.user_id ? props.user_id : params.sub\n        this.update()\n        this.state = {\n            msgs: null,\n            payload: {\n                body: '',\n                type: 'text'\n            }\n        }\n    }\n\n    componentDidMount() {\n        this.interval = setInterval(this.update, 600000);\n    }\n\n    componentWillUnmount() {\n        clearInterval(this.interval);\n    }\n\n    update = () => {\n        console.log('GETTING CHAT')\n        makeGetRequest(`admin-chat?user_id=${this.user_id}`,\n            (data) => {\n                console.log(data)\n                data= data.chats\n                data = data.map(\n                    (msg) => {\n                        console.log('MSG:', msg)\n                        if (msg.sender == null) {\n                            return null\n                        }\n                        else {\n                            return (\n                                <div className={msg.sender == 'us' ? 'msg adla' : 'msg'}>\n                                    {msg.body}\n                                    {\n                                        msg.our_instagram_media_url ?\n                                        <img src={msg.our_instagram_media_url} />\n                                        :\n                                        null\n                                    }\n                                </div>\n                            )\n                        }\n                    }\n                )\n                this.setState({msgs: data})\n            }\n        )\n    }\n    \n    handleBodyChange = (e) => {\n        this.setState({\n            payload: {\n                ...this.state.payload,\n                body: e.target.value\n            }\n        },\n            () => {\n                // console.log(this.state.payload.body)\n            }\n        )\n    }\n\n    sendMessage = () => {\n        console.log('SENDING:', this.state.payload)\n        makePostRequest(`admin-chat?user_id=${this.user_id}`,\n            this.state.payload,\n            () => {\n                console.log('message sent')\n            }\n        )\n        this.setState({payload: {...this.state.payload, body: ''}})\n    }\n\n    render() {\n\n        return (\n\n                <div className=\"panel\">\n                    <div className=\"medium\">\n                        Adla's chat with them\n                    </div>\n                    <div id=\"chat\">\n                        <div id=\"msgs\">\n                            {this.state.msgs}\n                        </div>\n                        {/* <div id=\"reply\">\n                            <input id=\"textarea\" value={this.state.payload.body} placeholder=\"Type a message\" onChange={this.handleBodyChange}/>\n                            {/* <input type=\"file\" id=\"img_input\" />\n                            <label for=\"img_input\" id=\"send_img\" class=\"btn\">\n                                <img src={ig} id=\"icon\" />\n                            </label> \n                            <div id=\"send_btn\" class=\"btn\" onClick={this.sendMessage}>\n                                <img src={send} id=\"icon\" />\n                            </div>\n                        </div> */}\n\n                    </div>\n\n                    <div id=\"msg_prompts\">\n\n                    </div>\n\n                </div>\n        )\n    }\n}\n\nexport default Messaging"]},"metadata":{},"sourceType":"module"}