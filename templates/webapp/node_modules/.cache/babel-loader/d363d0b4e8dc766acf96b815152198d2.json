{"ast":null,"code":"import _defineProperty from \"/home/ice/test/test/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"/home/ice/test/test/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"/home/ice/test/test/src/CustomRoutes.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from \"react\";\nimport { Auth } from \"aws-amplify\";\nimport queryString from \"query-string\";\nimport { Route, Redirect } from \"react-router-dom\";\nexport class ProtectedRoute extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      ready: false,\n      userInfo: null\n    };\n    Auth.currentSession().then(data => {\n      if (data) {\n        this.setState({\n          user: data\n        });\n      }\n    }).then(() => {\n      this.setState({\n        ready: true\n      });\n    }).catch(err => {\n      console.log(err);\n      this.setState({\n        ready: true\n      });\n    });\n  }\n\n  render() {\n    const _this$props = this.props,\n          Component = _this$props.component,\n          props = _objectWithoutProperties(_this$props, [\"component\"]);\n\n    if (this.state.ready) {\n      console.log('user:', this.state.user);\n      return React.createElement(Route, Object.assign({}, props, {\n        render: props => this.state.user ? React.createElement(Component, Object.assign({}, props, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 42\n          },\n          __self: this\n        })) : React.createElement(Redirect, {\n          to: {\n            pathname: \"/login\" + window.location.search,\n            state: {\n              from: window.location.pathname\n            }\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 43\n          },\n          __self: this\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 38\n        },\n        __self: this\n      }));\n    } else {\n      return null;\n    }\n  }\n\n}\nexport class StylistProtectedRoute extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      ready: false,\n      userInfo: null,\n      user: null\n    };\n    Auth.currentSession().then(data => {\n      if (data) {\n        this.setState({\n          user: data\n        });\n      }\n    }).then(() => {\n      this.setState({\n        ready: true\n      });\n    }).catch(err => {\n      console.log(err);\n      this.setState({\n        ready: true\n      });\n    });\n  }\n\n  render() {\n    const _this$props2 = this.props,\n          Component = _this$props2.component,\n          props = _objectWithoutProperties(_this$props2, [\"component\"]);\n\n    if (this.state.ready) {\n      console.log('user:', this.state.user);\n      return React.createElement(Route, Object.assign({}, props, {\n        render: props => this.state.user && this.state.user.accessToken.payload['cognito:groups'] && this.state.user.accessToken.payload['cognito:groups'].includes('stylists') ? React.createElement(Component, Object.assign({}, props, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91\n          },\n          __self: this\n        })) : React.createElement(Redirect, {\n          to: {\n            pathname: \"/login\" + window.location.search,\n            state: {\n              from: window.location.pathname\n            }\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 92\n          },\n          __self: this\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }));\n    } else {\n      return null;\n    }\n  }\n\n}\nexport class AdminProtectedRoute extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      ready: false,\n      userInfo: null,\n      user: null\n    };\n    console.log('checking credentials');\n    Auth.currentSession().then(data => {\n      console.log('credentials:', data);\n\n      if (data) {\n        this.setState({\n          user: data\n        });\n      }\n    }).then(() => {\n      this.setState({\n        ready: true\n      });\n    }).catch(err => {\n      console.log(err);\n      this.setState({\n        ready: true\n      });\n    });\n  }\n\n  render() {\n    const _this$props3 = this.props,\n          Component = _this$props3.component,\n          props = _objectWithoutProperties(_this$props3, [\"component\"]); // console.log('ADMIN PROPS:', this.props)\n\n\n    console.log('routing to:', Component);\n    console.log('ROUTE LOCATION:', window.location);\n    var params = queryString.parse(window.location.search); // console.log('PARAMS:', params)\n\n    console.log('ROUTE STATE:', this.state);\n    console.log('USER:', this.state.user);\n\n    if (this.state.ready) {\n      console.log('routing', _objectSpread({}, props));\n      return React.createElement(Route, Object.assign({}, props, {\n        render: props => this.state.user && this.state.user.accessToken.payload['cognito:groups'] && this.state.user.accessToken.payload['cognito:groups'].includes('admin') ? React.createElement(Component, Object.assign({}, props, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 150\n          },\n          __self: this\n        })) : React.createElement(Redirect, {\n          to: {\n            pathname: '/login',\n            state: _objectSpread({}, params, {\n              from: window.location.pathname\n            })\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 151\n          },\n          __self: this\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }));\n    } else {\n      console.log('rendering null');\n      return null;\n    }\n  }\n\n}","map":{"version":3,"sources":["/home/ice/test/test/src/CustomRoutes.js"],"names":["React","Component","Auth","queryString","Route","Redirect","ProtectedRoute","constructor","props","state","ready","userInfo","currentSession","then","data","setState","user","catch","err","console","log","render","component","pathname","window","location","search","from","StylistProtectedRoute","accessToken","payload","includes","AdminProtectedRoute","params","parse"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\"\nimport { Auth } from \"aws-amplify\"\nimport queryString from \"query-string\"\nimport { Route, Redirect } from \"react-router-dom\"\n\nexport class ProtectedRoute extends Component {\n    constructor(props) {\n      super(props)\n      this.state = {\n          ready: false,\n          userInfo: null\n      }\n      Auth.currentSession()\n      .then(\n          (data) => {\n              if (data) {\n                  this.setState({\n                      user: data\n                  })\n              }\n          }\n      )\n      .then(\n        () => {\n          this.setState({ready: true})\n        }\n      )\n      .catch(\n        (err) => {console.log(err);this.setState({ready: true})}\n      )\n    }\n\n    render() {\n    const { component: Component, ...props } = this.props\n    if (this.state.ready) {\n        console.log('user:',this.state.user)\n        return (\n            <Route \n            {...props} \n            render = { props => (\n                this.state.user ?\n                <Component {...props} /> :\n                <Redirect to={{pathname: `/login` + window.location.search, state: {from: window.location.pathname}}}/>\n            )} \n            />\n        )\n    }\n    else {\n        return null\n    }\n    }\n}\n\nexport class StylistProtectedRoute extends Component {\n    constructor(props) {\n      super(props)\n      this.state = {\n          ready: false,\n          userInfo: null,\n          user: null\n      }\n      Auth.currentSession()\n      .then(\n          (data) => {\n              if (data) {\n                  this.setState({\n                      user: data\n                  })\n              }\n          }\n      )\n      .then(\n        () => {\n          this.setState({ready: true})\n        }\n      )\n      .catch(\n        (err) => {console.log(err);this.setState({ready: true})}\n      )\n    }\n\n    render() {\n    const { component: Component, ...props } = this.props\n    if (this.state.ready) {\n        console.log('user:',this.state.user)\n        return (\n            <Route \n            {...props} \n            render = { props => (\n                this.state.user && this.state.user.accessToken.payload['cognito:groups'] && this.state.user.accessToken.payload['cognito:groups'].includes('stylists') ?\n                <Component {...props} /> :\n                <Redirect to={{pathname: `/login` + window.location.search, state: {from: window.location.pathname}}}/>\n            )} \n            />\n        )\n    }\n    else {\n        return null\n    }\n    }\n}\n\nexport class AdminProtectedRoute extends Component {\n    constructor(props) {\n      super(props)\n      this.state = {\n          ready: false,\n          userInfo: null,\n          user: null\n      }\n      console.log('checking credentials')\n      Auth.currentSession()\n      .then(\n          (data) => {\n              console.log('credentials:', data)\n              if (data) {\n                  this.setState({\n                      user: data\n                  })\n              }\n          }\n      )\n      .then(\n        () => {\n          this.setState({ready: true})\n        }\n      )\n      .catch(\n        (err) => {console.log(err);this.setState({ready: true})}\n      )\n    }\n\n    render() {\n      const { component: Component, ...props } = this.props\n      // console.log('ADMIN PROPS:', this.props)\n      console.log('routing to:', Component)\n      console.log('ROUTE LOCATION:', window.location)\n      var params = queryString.parse(window.location.search)\n      // console.log('PARAMS:', params)\n      console.log('ROUTE STATE:', this.state)\n      console.log('USER:', this.state.user)\n\n      if (this.state.ready) {\n          console.log('routing', {...props})\n          return (\n            <Route \n              {...props} \n              render = { props => (\n                this.state.user && this.state.user.accessToken.payload['cognito:groups'] && this.state.user.accessToken.payload['cognito:groups'].includes('admin') ?\n                  <Component {...props} /> :\n                  <Redirect to={{pathname: '/login', state: {...params, from: window.location.pathname}}} />\n              )} \n            />\n          )\n      }\n      else {\n        console.log('rendering null')\n        return null\n      }\n    }\n}"]},"metadata":{},"sourceType":"module"}