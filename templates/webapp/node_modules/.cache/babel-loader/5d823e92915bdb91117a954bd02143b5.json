{"ast":null,"code":"import _defineProperty from \"/home/ice/test/test/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/ice/test/test/src/adminComponents/MakeRecommendations.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from \"react\";\nimport Dropdown from \"../general/form_components/Dropdown\";\nimport gradient from \"../images/gradient.png\";\nimport \"./MakeRecommendations.css\";\nimport { connect } from \"react-redux\";\nimport { Auth, Storage, JS } from \"aws-amplify\";\nimport uuid from \"uuid\";\nimport queryString from \"query-string\";\nimport { makeGetRequest, makePostRequest } from \"../api_calls\";\nimport Loading from \"../general/Loading\"; // import bad_img from \"../images/misc/bad_img.jpg\"\n// import good_img from \"../images/misc/good_img.jpg\"\n// import Style from \"../components/Style\";\n\nimport sendIcon from \"../images/icons/send.svg\";\nexport class AddRecItem extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleTextChange = e => {\n      console.log('event target:', e.target);\n      var val = e.target.id == 'tags' ? e.target.value.split(/,\\s*/) : e.target.value;\n      val = e.target.id == 'price' ? val = val.replace(/[^0-9.]/, '') // val = val.match(/^\\d+(\\.\\d{1,2})?$/)\n      : val;\n      this.setState({\n        item: _objectSpread({}, this.state.item, {\n          [e.target.id]: val\n        })\n      }, () => {\n        console.log('item:', this.state.item);\n      });\n    };\n\n    this.handleOptionChange = event => {\n      this.setState({\n        item: _objectSpread({}, this.state.item, {\n          [event.target.name]: event.target.value\n        })\n      }, () => {\n        console.log('setting currency:', this.state);\n      });\n    };\n\n    this.handleArrayOptionChange = e => {\n      console.log('TARGET:', e.target);\n      var options = this.state.item[e.target.name];\n\n      if (options.includes(e.target.id)) {\n        console.log('removing style');\n        options = options.filter(item => {\n          return item != e.target.id;\n        });\n      } else {\n        console.log('addign style');\n        options.push(e.target.id);\n      }\n\n      this.setState({\n        item: _objectSpread({}, this.state.item, {\n          [e.target.name]: options\n        })\n      }, console.log('array:', this.state.item[e.target.name]));\n    };\n\n    this.handleRequestChange = e => {\n      this.setState({\n        request: e.target.value\n      }, () => {\n        console.log(this.state);\n      });\n    };\n\n    this.submitRequest = () => {\n      var request = this.state.request.toLowerCase();\n\n      if (request != '') {\n        var key = this.state.page == 6 ? 'allTypes' : 'allStyles';\n\n        if (!this.state[key].includes(request)) {\n          // if requested key not in list of all keys\n          this.setState({\n            [key]: [...this.state[key], request]\n          });\n          makePostRequest('feature-request', {\n            type: 'new tag request',\n            request: request\n          }); // alert me\n        }\n\n        this.setState({\n          request: ''\n        });\n        this.handleArrayOptionChange({\n          target: {\n            id: request,\n            name: this.state.page == 6 ? 'product_type' : 'tags'\n          }\n        });\n      }\n    };\n\n    this.getImgs = () => {\n      console.log('getting imgs');\n      console.log('prevs srcs:', this.state.img_previews);\n      var img_prevs = this.state.img_previews.map(img => {\n        return React.createElement(\"img\", {\n          src: img,\n          alt: \"\",\n          className: \"rec-img-thumb\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137\n          },\n          __self: this\n        });\n      });\n      console.log('IMG PREVIEWS:', img_prevs);\n      return img_prevs;\n    };\n\n    this.setImgs = e => {\n      console.log('setting imgs');\n\n      if (e.target.files[e.target.files.length - 1].type.split('/')[1] == 'webp') {\n        alert('Please do not use images with a \".webp\" file extension. Use \".JPG\" or \".png\" images :)');\n        return null;\n      }\n\n      this.setState({\n        img_files: e.target.files\n      }, () => {\n        console.log('set img files:', this.state.img_files);\n      });\n\n      for (var x = 0, xlen = e.target.files.length; x < xlen; x++) {\n        var file = e.target.files[x];\n\n        if (file.type.indexOf('image') != -1) {\n          // Very primitive \"validation\"\n          var reader = new FileReader();\n\n          reader.onload = function (i) {\n            var img_src = i.target.result;\n            console.log('img:', img_src);\n            this.setState({\n              img_previews: [...this.state.img_previews, img_src]\n            }, () => console.log('set img previews:', this.state.img_previews));\n          }.bind(this);\n\n          reader.readAsDataURL(file);\n        }\n      }\n    };\n\n    this.next = () => {\n      this.setState({\n        page: this.state.page + 1\n      });\n    };\n\n    this.previous = () => {\n      this.setState({\n        page: this.state.page - 1\n      });\n    };\n\n    this.saveFiles = files => {\n      return new Promise((resolve, reject) => {\n        var type;\n        var url;\n        var fp;\n\n        for (var i = 0; i < files.length; i++) {\n          type = files[i].type.split('/')[1];\n          fp = \"recommended_items/\".concat(uuid.v4(), \".\").concat(type);\n          var mimeType;\n\n          if (type == 'png') {\n            mimeType = 'image/png';\n          } else if (type == 'jpg' || type == 'jpeg') {\n            mimeType = 'image/jpeg';\n          } else {\n            alert('image type invalid (use .PNG, .JPG or .JPEG images)\\nYou used type ' + type);\n            return null;\n          }\n\n          console.log('puttin');\n          Storage.put(fp, files[i], {\n            contentType: mimeType\n          }).then(() => {\n            url = \"https://s3-eu-west-1.amazonaws.com/adla-data/public/\".concat(fp);\n            this.setState({\n              item: _objectSpread({}, this.state.item, {\n                img_urls: [...this.state.item.img_urls, url]\n              })\n            }, () => {\n              if (this.state.item.img_urls.length == files.length) {\n                resolve();\n              }\n            });\n          }).catch(err => {\n            alert('ERROR:', err);\n          }); //.catch(reject(Error('The following file failed to upload:', files[i])))\n        }\n      });\n    };\n\n    this.recommendItem = () => {\n      this.setState({\n        loading: true\n      });\n      console.log('adding image');\n      var files = this.state.img_files;\n      console.log('files:', files);\n      this.saveFiles(files).then(url => {\n        console.log('now posting request');\n        var loc = window.location.search;\n        var params = queryString.parse(loc);\n        var sub = params.sub;\n        var req_id = params.req_id; // var endpoint = `update-recommendation?sub=${sub}&req_id=${req_id}`\n\n        var endpoint = \"update-recommendation?sub=\".concat(sub);\n        var body = this.state.item;\n\n        for (var i in body) {\n          console.log(i);\n\n          if (body[i] === null || body[i] === undefined || body[i].length === 0) {\n            console.log('removing:', i);\n            delete body[i];\n          }\n        }\n\n        var rec = _objectSpread({}, body, {\n          user_id: sub\n        });\n\n        delete rec['action'];\n        body = {\n          recs: [rec],\n          action: 'recommend'\n          /*.filter((key, index) => {\n              return body[key] != ''\n          });\n          */\n\n        };\n        console.log(body);\n        makePostRequest(endpoint, body, data => {\n          console.log('done adding item to recommendations');\n          data.json().then(data => {\n            console.log(data); // this.props.onRecommend()\n\n            this.setState({\n              loading: false\n            });\n            this.props.closeModal();\n            this.props.getRecommended().then(recs => {\n              var prompts = ['Nice work!', 'Rec made!', 'Great work!', 'That\\'s it!', 'Success!', 'Done'];\n              var num_left = 5 - recs.length;\n              var update;\n\n              if (num_left > 0) {\n                update = \"Make \".concat(num_left, \" more recommendation\").concat(num_left > 1 ? 's' : '', \" to send these items to the user!\");\n              } else {\n                update = 'These recommendations will be sent to the user soon!';\n              }\n\n              var prompt = prompts[Math.floor(Math.random() * prompts.length)];\n              console.log('got recs:', recs);\n              this.props.notify(React.createElement(\"div\", {\n                className: \"small\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 292\n                },\n                __self: this\n              }, React.createElement(\"strong\", {\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 293\n                },\n                __self: this\n              }, prompt + ' ' + update)));\n            });\n          });\n        }, () => {\n          this.props.notify(React.createElement(\"div\", {\n            className: \"medium\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 305\n            },\n            __self: this\n          }, \"Something went wrong \\uD83D\\uDE2D. Let Harry know!\"));\n        });\n      }).catch(err => alert(err));\n    };\n\n    this.state = {\n      item: {\n        img_urls: [],\n        url: '',\n        brand: '',\n        price: '',\n        currency: null,\n        tags: [],\n        action: 'recommend',\n        caption: '',\n        product_type: []\n      },\n      allStyles: window.styles,\n      allTypes: ['t-shirt', 'top', 'jeans', 'pants', 'swimwear', 'jacket', 'shoes', 'dress', 'skirt', 'tracksuit', 'shirt', 'hoody', 'sweater', 'skort', 'bag', 'blouse'].sort(),\n      request: '',\n      img_files: [],\n      img_previews: [],\n      page: 1,\n      loading: false\n    };\n  }\n\n  render() {\n    var sub = queryString.parse(window.location.search).sub;\n    var page = this.state.page;\n    var disabled;\n    var style;\n\n    if (page == 1) {\n      disabled = this.state.img_files.length == 0;\n      style = {\n        opacity: disabled ? 0.5 : 1\n      };\n      return React.createElement(\"div\", {\n        className: \"add-rec-item\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 325\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"medium\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 326\n        },\n        __self: this\n      }, \"1. Upload images of the product\"), React.createElement(\"div\", {\n        className: \"small\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 329\n        },\n        __self: this\n      }, \"The user will receive the first image that you upload, exactly as you upload it\"), React.createElement(\"div\", {\n        style: {\n          width: \"90vw\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 359\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"rec-img-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 360\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"small\",\n        style: {\n          float: \"left\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 361\n        },\n        __self: this\n      }, \"Images\"), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 364\n        },\n        __self: this\n      }, this.getImgs())), React.createElement(\"div\", {\n        className: \"btn rec-img-upload\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 368\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        id: \"upload-rec-img\",\n        type: \"file\",\n        style: {\n          display: \"none\"\n        },\n        accept: \"image/*\",\n        name: \"img\",\n        onChange: this.setImgs,\n        multiple: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 369\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        for: \"upload-rec-img\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 370\n        },\n        __self: this\n      }, \"Add images\"))), React.createElement(\"button\", {\n        className: \"btn\",\n        onClick: this.next,\n        disabled: disabled,\n        style: style,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 373\n        },\n        __self: this\n      }, \"Next step!\"));\n    } else if (page == 2) {\n      disabled = this.state.item.caption == '';\n      style = {\n        opacity: disabled ? 0.5 : 1\n      };\n      return React.createElement(\"div\", {\n        className: \"add-rec-item\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 383\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"medium\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 384\n        },\n        __self: this\n      }, \"2. Send a message to the user along with this item\"), React.createElement(\"div\", {\n        className: \"add-item-input\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 387\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"small\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 388\n        },\n        __self: this\n      }, \"Let them know why you made this specific recommendation.\", React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 390\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 391\n        },\n        __self: this\n      }), \"Examples:\", React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 393\n        },\n        __self: this\n      }), \"This will go perfectly with the red jacket you own.\", React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 395\n        },\n        __self: this\n      }), \"This is the best material to keep you cool on your holiday that you told me about.\", React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 397\n        },\n        __self: this\n      }), \"It's 20% off!\", React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 399\n        },\n        __self: this\n      }), \"ETC\"), React.createElement(\"input\", {\n        id: \"caption\",\n        className: \"add-item-input-field medium\",\n        value: this.state.item.caption,\n        onChange: this.handleTextChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 402\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        style: {\n          display: \"flex\",\n          flexWrap: \"wrap\",\n          justifyContent: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 404\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"btn\",\n        onClick: this.previous,\n        style: {\n          minWidth: \"50px\",\n          width: \"auto\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 405\n        },\n        __self: this\n      }, \"Back\"), React.createElement(\"button\", {\n        className: \"btn\",\n        onClick: this.next,\n        disabled: disabled,\n        style: style,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 408\n        },\n        __self: this\n      }, \"Next step!\")));\n    } else if (page == 3) {\n      disabled = this.state.item.brand == '';\n      style = {\n        opacity: disabled ? 0.5 : 1\n      };\n      return React.createElement(\"div\", {\n        className: \"add-rec-item\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 419\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"medium\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 420\n        },\n        __self: this\n      }, \"3. The brand\"), React.createElement(\"div\", {\n        className: \"add-item-input\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 423\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"small\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 424\n        },\n        __self: this\n      }, \"What brand is the product from?\"), React.createElement(\"input\", {\n        id: \"brand\",\n        className: \"add-item-input-field medium\",\n        value: this.state.item.brand,\n        onChange: this.handleTextChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 427\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        style: {\n          display: \"flex\",\n          flexWrap: \"wrap\",\n          justifyContent: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 429\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"btn\",\n        onClick: this.previous,\n        style: {\n          minWidth: \"50px\",\n          width: \"auto\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 430\n        },\n        __self: this\n      }, \"Back\"), React.createElement(\"button\", {\n        className: \"btn\",\n        onClick: this.next,\n        disabled: disabled,\n        style: style,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 433\n        },\n        __self: this\n      }, \"Next step!\")));\n    } else if (page == 4) {\n      disabled = this.state.item.url == '';\n      style = {\n        opacity: disabled ? 0.5 : 1\n      };\n      return React.createElement(\"div\", {\n        className: \"add-rec-item\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 444\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"medium\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 445\n        },\n        __self: this\n      }, \"4. The URL\"), React.createElement(\"div\", {\n        className: \"add-item-input\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 448\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"small\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 449\n        },\n        __self: this\n      }, \"Enter the web URL where you can buy the product from\"), React.createElement(\"input\", {\n        id: \"url\",\n        className: \"add-item-input-field medium\",\n        value: this.state.item.url,\n        onChange: this.handleTextChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 452\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        style: {\n          display: \"flex\",\n          flexWrap: \"wrap\",\n          justifyContent: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 454\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"btn\",\n        onClick: this.previous,\n        style: {\n          minWidth: \"50px\",\n          width: \"auto\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 455\n        },\n        __self: this\n      }, \"Back\"), React.createElement(\"button\", {\n        className: \"btn\",\n        onClick: this.next,\n        disabled: disabled,\n        style: style,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 458\n        },\n        __self: this\n      }, \"Next step!\")));\n    } else if (page == 5) {\n      disabled = this.state.item.price == '' || !this.state.item.currency;\n      style = {\n        opacity: disabled ? 0.5 : 1\n      };\n      return React.createElement(\"div\", {\n        className: \"add-rec-item\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 469\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"medium\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 470\n        },\n        __self: this\n      }, \"5. Price\"), React.createElement(\"div\", {\n        className: \"add-item-input\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 473\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"small\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 474\n        },\n        __self: this\n      }, \"What's the price?\"), React.createElement(\"input\", {\n        id: \"price\",\n        className: \"add-item-input-field medium text-response\",\n        value: this.state.item.price,\n        onChange: this.handleTextChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 477\n        },\n        __self: this\n      }), React.createElement(Dropdown, {\n        onChange: this.handleOptionChange,\n        id: \"currency\",\n        value: this.state.currency,\n        prompt: \"What currency?\",\n        name: \"currency\",\n        options: ['$', 'Â£'],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 478\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        style: {\n          display: \"flex\",\n          flexWrap: \"wrap\",\n          justifyContent: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 480\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"btn\",\n        onClick: this.previous,\n        style: {\n          minWidth: \"50px\",\n          width: \"auto\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 481\n        },\n        __self: this\n      }, \"Back\"), React.createElement(\"button\", {\n        className: \"btn\",\n        onClick: this.next,\n        disabled: disabled,\n        style: style,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 484\n        },\n        __self: this\n      }, \"Next step!\")));\n    } else if (page == 6) {\n      disabled = this.state.item.product_type.length <= 0;\n      style = {\n        opacity: disabled ? 0.5 : 1\n      };\n      var allOptions = this.state.allTypes;\n      var options = this.state.item.product_type;\n      return React.createElement(\"div\", {\n        className: \"add-rec-item\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 497\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"add-item-input\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 498\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"medium\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 499\n        },\n        __self: this\n      }, \"6. Product type\"), React.createElement(\"div\", {\n        className: \"panel\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 505\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"\",\n        style: {\n          display: 'flex',\n          flexWrap: 'wrap',\n          justifyContent: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 506\n        },\n        __self: this\n      }, allOptions.map(item => {\n        // console.log(item)\n        var opacity = options.includes(item) ? '1' : '0.5';\n        return React.createElement(React.Fragment, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 512\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          for: item,\n          style: {\n            opacity\n          },\n          value: options.includes(item),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 513\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          className: \"btn text-btn\",\n          id: item,\n          name: \"product_type\",\n          onClick: this.handleArrayOptionChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 514\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          className: \"radio_btn\",\n          type: \"radio\",\n          checked: options.includes(item),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 515\n          },\n          __self: this\n        }), item)));\n      })), React.createElement(\"div\", {\n        style: {\n          marginTop: '30px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 524\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 525\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 525\n        },\n        __self: this\n      }, \"Something else?\")), React.createElement(\"div\", {\n        className: \"searchbar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 526\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        value: this.state.request,\n        onChange: this.handleRequestChange,\n        className: \"text-response\",\n        placeholder: \"Enter a missing type...\",\n        style: {\n          fontSize: '13px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 527\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        onClick: this.submitRequest,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 528\n        },\n        __self: this\n      }, this.state.request_loading ? React.createElement(Loading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 531\n        },\n        __self: this\n      }) : React.createElement(\"img\", {\n        src: sendIcon,\n        style: {\n          height: '30px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 533\n        },\n        __self: this\n      })))))), React.createElement(\"div\", {\n        style: {\n          display: \"flex\",\n          flexWrap: \"wrap\",\n          justifyContent: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 544\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"btn\",\n        onClick: this.previous,\n        style: {\n          minWidth: \"50px\",\n          width: \"auto\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 545\n        },\n        __self: this\n      }, \"Back\"), React.createElement(\"button\", {\n        className: \"btn\",\n        onClick: this.next,\n        disabled: disabled,\n        style: style,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 548\n        },\n        __self: this\n      }, \"Next!\")));\n    } else if (page == 7) {\n      disabled = this.state.item.tags.length <= 0;\n      style = {\n        opacity: disabled ? 0.5 : 1\n      };\n      var allStyles = this.state.allStyles;\n      var styles = this.state.item.tags;\n      return React.createElement(\"div\", {\n        className: \"add-rec-item\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 561\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"add-item-input\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 562\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"medium\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 563\n        },\n        __self: this\n      }, \"6. Tag the product\"), React.createElement(\"div\", {\n        className: \"panel\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 569\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"medium\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 570\n        },\n        __self: this\n      }, this.props.title), React.createElement(\"div\", {\n        className: \"\",\n        style: {\n          display: 'flex',\n          flexWrap: 'wrap',\n          justifyContent: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 574\n        },\n        __self: this\n      }, allStyles.map(item => {\n        // console.log(item)\n        var opacity = styles.includes(item) ? '1' : '0.5';\n        return React.createElement(React.Fragment, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 580\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          for: item,\n          style: {\n            opacity\n          },\n          value: styles.includes(item),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 581\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          className: \"btn text-btn\",\n          id: item,\n          name: \"tags\",\n          onClick: this.handleArrayOptionChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 582\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          className: \"radio_btn\",\n          type: \"radio\",\n          checked: styles.includes(item),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 583\n          },\n          __self: this\n        }), item)));\n      })), React.createElement(\"div\", {\n        style: {\n          marginTop: '30px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 592\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 593\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 593\n        },\n        __self: this\n      }, \"Enter your own tag!\")), React.createElement(\"div\", {\n        className: \"searchbar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 594\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        value: this.state.request,\n        onChange: this.handleRequestChange,\n        className: \"text-response\",\n        placeholder: \"Enter a missing word...\",\n        style: {\n          fontSize: '13px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 595\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        onClick: this.submitRequest,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 596\n        },\n        __self: this\n      }, this.state.request_loading ? React.createElement(Loading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 599\n        },\n        __self: this\n      }) : React.createElement(\"img\", {\n        src: sendIcon,\n        style: {\n          height: '30px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 601\n        },\n        __self: this\n      })))))), React.createElement(\"div\", {\n        style: {\n          display: \"flex\",\n          flexWrap: \"wrap\",\n          justifyContent: \"center\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 612\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"btn\",\n        onClick: this.previous,\n        style: {\n          minWidth: \"50px\",\n          width: \"auto\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 613\n        },\n        __self: this\n      }, \"Back\"), React.createElement(\"button\", {\n        className: \"btn\",\n        onClick: this.recommendItem,\n        disabled: disabled,\n        style: style,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 616\n        },\n        __self: this\n      }, this.state.loading ? React.createElement(Loading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 619\n        },\n        __self: this\n      }) : 'Recommend!')));\n    }\n  }\n\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    openModal: content => {\n      console.log('content:', content);\n      dispatch({\n        type: \"OPEN_MODAL\",\n        content: content\n      });\n    },\n    closeModal: () => {\n      dispatch({\n        type: \"CLOSE_MODAL\"\n      });\n    },\n    closeSlideUp: () => {\n      dispatch({\n        type: \"CLOSE_SLIDEUP\"\n      });\n    },\n    notify: content => {\n      dispatch({\n        type: \"NOTIFY\",\n        content\n      });\n    }\n  };\n};\n\nexport default AddRecItem = connect(null, mapDispatchToProps)(AddRecItem);\n\nclass MakeRecommendations extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = () => {\n      console.log('getting recommendations');\n      this.getRecs();\n    };\n\n    this.getRecs = () => {\n      console.log('getting latest recommendations');\n      var params = queryString.parse(window.location.search);\n      console.log(params);\n      var req_id = params.req_id;\n      /*\n      makeGetRequest(`recommendations?req_id=${req_id}`, \n          (recs) =>{\n              console.log('got recommendations')\n              recs = recs.body\n              recs = JSON.parse(recs)\n              console.log('recommendations:', recs)\n              recs = recs.map(\n                  (rec) => {\n                      return <RecommendationItem src={rec.img_urls[0]} id={rec['Item ID']}/>//<img src={rec.img_urls[0]} alt=\"\" className=\"rec-img-thumb\"/>\n                  }\n              )\n              this.setState({recs: recs},\n                  console.log(this.state)    \n              )\n          }\n      )\n      */\n    };\n\n    this.makeRecommendations = () => {\n      var req_id = queryString.parse(window.location.search).req_id;\n      var sub = queryString.parse(window.location.search).sub;\n      makePostRequest(\"update-order-status?sub=\".concat(sub, \"&req_id=\").concat(req_id), {\n        nextStatus: 'recommendations_made'\n      }, () => {\n        console.log('order updated');\n      });\n      this.props.refresh();\n    };\n\n    this.state = {\n      recs: []\n    };\n  }\n\n  render() {\n    console.log(this.props);\n    return React.createElement(\"div\", {\n      className: \"medium slideUp-content\",\n      style: {\n        position: \"absolute\",\n        top: \"8vh\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 713\n      },\n      __self: this\n    }, \"Make recommendations\", React.createElement(\"div\", {\n      className: \"recommendations-to-be-made\",\n      style: {\n        padding: \"10px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 715\n      },\n      __self: this\n    }, this.state.recs), React.createElement(\"div\", {\n      className: \"btn small\",\n      onClick: () => this.props.openModal(React.createElement(AddRecItem, {\n        onRecommend: this.props.refresh,\n        closeModal: this.props.closeModal,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 718\n        },\n        __self: this\n      })),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 718\n      },\n      __self: this\n    }, \"Recommend a new item!\"), React.createElement(\"div\", {\n      className: \"btn small\",\n      onClick: this.clo,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 721\n      },\n      __self: this\n    }, \"Send these recommendations\"));\n  }\n\n}\n\nclass RecommendationItem extends Component {\n  render() {\n    return React.createElement(\"div\", {\n      className: \"recommendation-item\",\n      id: this.props.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 733\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      className: \"rec-img-thumb\",\n      src: this.props.src,\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 734\n      },\n      __self: this\n    }));\n  }\n\n}","map":{"version":3,"sources":["/home/ice/test/test/src/adminComponents/MakeRecommendations.js"],"names":["React","Component","Dropdown","gradient","connect","Auth","Storage","JS","uuid","queryString","makeGetRequest","makePostRequest","Loading","AddRecItem","constructor","props","handleTextChange","e","console","log","target","val","id","value","split","replace","setState","item","state","handleOptionChange","event","name","handleArrayOptionChange","options","includes","filter","push","handleRequestChange","request","submitRequest","toLowerCase","key","page","type","getImgs","img_previews","img_prevs","map","img","setImgs","files","length","alert","img_files","x","xlen","file","indexOf","reader","FileReader","onload","i","img_src","result","bind","readAsDataURL","next","previous","saveFiles","Promise","resolve","reject","url","fp","v4","mimeType","put","contentType","then","img_urls","catch","err","recommendItem","loading","loc","window","location","search","params","parse","sub","req_id","endpoint","body","undefined","rec","user_id","recs","action","data","json","closeModal","getRecommended","prompts","num_left","update","prompt","Math","floor","random","notify","brand","price","currency","tags","caption","product_type","allStyles","styles","allTypes","sort","render","disabled","style","opacity","width","float","display","flexWrap","justifyContent","minWidth","allOptions","marginTop","fontSize","request_loading","sendIcon","height","title","mapDispatchToProps","dispatch","openModal","content","closeSlideUp","MakeRecommendations","componentDidMount","getRecs","makeRecommendations","nextStatus","refresh","position","top","padding","clo","RecommendationItem","src"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\"\nimport Dropdown from \"../general/form_components/Dropdown\"\nimport gradient from \"../images/gradient.png\"\nimport \"./MakeRecommendations.css\"\nimport { connect } from \"react-redux\";\nimport { Auth, Storage, JS } from \"aws-amplify\"\nimport uuid from \"uuid\"\nimport queryString from \"query-string\"\nimport { makeGetRequest, makePostRequest } from \"../api_calls\"\nimport Loading from \"../general/Loading\"\n// import bad_img from \"../images/misc/bad_img.jpg\"\n// import good_img from \"../images/misc/good_img.jpg\"\n// import Style from \"../components/Style\";\nimport sendIcon from \"../images/icons/send.svg\"\n\nexport class AddRecItem extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            item: {\n                img_urls: [],\n                url: '',\n                brand: '',\n                price: '',\n                currency: null,\n                tags: [],\n                action: 'recommend',\n                caption: '',\n                product_type: []\n            },\n            allStyles: window.styles,\n            allTypes: [\n                't-shirt',\n                'top',\n                'jeans',\n                'pants',\n                'swimwear',\n                'jacket',\n                'shoes',\n                'dress',\n                'skirt',\n                'tracksuit',\n                'shirt',\n                'hoody',\n                'sweater',\n                'skort',\n                'bag',\n                'blouse'\n            ].sort(),\n            request: '',\n            img_files: [],\n            img_previews : [],\n            page: 1,\n            loading: false\n        }\n    }\n\n    handleTextChange = (e) => {\n        console.log('event target:', e.target)\n        var val = (e.target.id == 'tags') ? \n            e.target.value.split(/,\\s*/) : \n            e.target.value\n        val = (e.target.id == 'price') ?\n            val = val.replace(/[^0-9.]/, '')\n            // val = val.match(/^\\d+(\\.\\d{1,2})?$/)\n            :\n            val\n        this.setState({\n            item: {\n                ...this.state.item,\n                [e.target.id]: val\n            }\n        }, \n        () => {\n            console.log('item:', this.state.item)\n        }\n        )\n    }\n\n    handleOptionChange = (event) => {\n        this.setState({\n            item: {\n                ...this.state.item,\n                [event.target.name]: event.target.value\n            }\n        },\n        () => {\n            console.log('setting currency:', this.state)\n        }\n        )\n    }\n\n    handleArrayOptionChange = (e) => {\n        console.log('TARGET:', e.target)\n        var options = this.state.item[e.target.name]\n        if (options.includes(e.target.id)) {\n            console.log('removing style')\n            options = options.filter( (item) => {return item != e.target.id} )\n        }\n        else {\n            console.log('addign style')\n            options.push(e.target.id)\n        }\n        this.setState({item: {...this.state.item, [e.target.name]: options}},\n            console.log('array:', this.state.item[e.target.name])\n        )\n    }\n\n    handleRequestChange = (e) => {\n        this.setState({request: e.target.value},\n            () => {console.log(this.state)}    \n        )\n    }\n\n    submitRequest = () => {\n        var request = this.state.request.toLowerCase()\n        if (request != '') {\n            var key = this.state.page == 6 ? 'allTypes' : 'allStyles'\n            if (! this.state[key].includes(request)) {        // if requested key not in list of all keys\n                this.setState({\n                    [key]: [...this.state[key], request],\n                })\n                makePostRequest('feature-request', {type: 'new tag request', request: request}) // alert me\n            }\n            this.setState({\n                request: ''\n            })\n            this.handleArrayOptionChange({target: {id: request, name: this.state.page == 6 ? 'product_type' : 'tags'}})\n        }\n    }\n\n    getImgs = () => {\n        console.log('getting imgs')\n        console.log('prevs srcs:', this.state.img_previews)\n        var img_prevs = this.state.img_previews.map(\n            (img) => {\n                return <img src={img} alt=\"\" className=\"rec-img-thumb\"/>\n            }\n        )\n        console.log('IMG PREVIEWS:', img_prevs)\n        return img_prevs\n    }\n\n    setImgs = (e) => {\n        console.log('setting imgs')\n        if (e.target.files[e.target.files.length - 1].type.split('/')[1] == 'webp') {\n            alert('Please do not use images with a \".webp\" file extension. Use \".JPG\" or \".png\" images :)')\n            return null\n        }\n\n        this.setState({img_files: e.target.files},\n            () => {console.log('set img files:', this.state.img_files)}    \n        )\n        for(var x = 0, xlen = e.target.files.length; x < xlen; x++) {\n            var file = e.target.files[x];\n            if(file.type.indexOf('image') != -1) { // Very primitive \"validation\"\n                var reader = new FileReader();\n                reader.onload = function(i) {\n                    var img_src = i.target.result;\n                    console.log('img:', img_src)\n                    this.setState({\n                        img_previews: [...this.state.img_previews, img_src]\n                    },\n                        () => console.log('set img previews:', this.state.img_previews)\n                    )\n                }.bind(this)\n                reader.readAsDataURL(file);\n            }\n        }\n    }\n\n    next = () => {\n        this.setState({page: this.state.page + 1})\n    }\n\n    previous = () => {\n        this.setState({page: this.state.page - 1})\n    }\n\n    saveFiles = (files) => {\n        return new Promise(\n            (resolve, reject) => {\n                var type\n                var url\n                var fp\n                for (var i=0; i<files.length; i++) {\n                    type = files[i].type.split('/')[1]\n                    fp = `recommended_items/${uuid.v4()}.${type}`\n                    var mimeType \n                    if (type == 'png') {\n                        mimeType = 'image/png'\n                    }\n                    else if (type == 'jpg' || type == 'jpeg') {\n                        mimeType = 'image/jpeg'\n                    }\n                    else {\n                        alert('image type invalid (use .PNG, .JPG or .JPEG images)\\nYou used type ' + type)\n                        return null\n                    }\n                    console.log('puttin')\n                    Storage.put(fp, files[i], {contentType: mimeType})\n                    .then(\n                        () => {\n                            url =`https://s3-eu-west-1.amazonaws.com/adla-data/public/${fp}`\n                            this.setState({\n                                item: {\n                                    ...this.state.item,\n                                    img_urls: [...this.state.item.img_urls, url]\n                                }\n                            }, \n                                () => {\n                                    if (this.state.item.img_urls.length == files.length) {\n                                        resolve()\n                                    }\n                                }\n                            )\n                        }\n                    )\n                    .catch((err) => {alert('ERROR:', err)})\n                    //.catch(reject(Error('The following file failed to upload:', files[i])))\n                }\n            }\n        )\n    }\n    \n    recommendItem = () => {\n        this.setState({loading: true})\n        console.log('adding image')\n        var files = this.state.img_files\n        console.log('files:', files)\n        this.saveFiles(files)\n        .then(\n            url => {\n                console.log('now posting request')\n                var loc = window.location.search\n                var params = queryString.parse(loc)\n                var sub = params.sub\n                var req_id = params.req_id\n\n                // var endpoint = `update-recommendation?sub=${sub}&req_id=${req_id}`\n                var endpoint = `update-recommendation?sub=${sub}`\n                var body = this.state.item\n                for (var i in body) { \n                    console.log(i)\n                    if (body[i] === null || body[i] === undefined || body[i].length === 0) {\n                        console.log('removing:', i)\n                        delete body[i]\n                    }\n                }\n\n                var rec = {...body, user_id: sub}\n                delete rec['action']\n                body = {recs: [rec], action: 'recommend'}\n                \n                /*.filter((key, index) => {\n                    return body[key] != ''\n                });\n                */\n                console.log(body)\n                makePostRequest(endpoint, body,\n                    (data) => {\n                        console.log('done adding item to recommendations')\n                        data.json()\n                        .then(\n                            (data) => {\n                                console.log(data)\n                                // this.props.onRecommend()\n                                this.setState({loading: false})\n                                this.props.closeModal()\n                                this.props.getRecommended()\n                                .then(\n                                    (recs) => {\n                                        var prompts = [\n                                            'Nice work!',\n                                            'Rec made!',\n                                            'Great work!',\n                                            'That\\'s it!',\n                                            'Success!',\n                                            'Done'\n                                        ]\n                                        var num_left = 5 - recs.length\n                                        var update\n                                        if (num_left > 0) {\n                                            update = `Make ${num_left} more recommendation${num_left > 1 ? 's' : ''} to send these items to the user!`\n                                        }\n                                        else {\n                                            update = 'These recommendations will be sent to the user soon!'\n                                        }\n                                        var prompt = prompts[Math.floor(Math.random() * prompts.length)]\n                                        console.log('got recs:', recs)\n                                        this.props.notify(\n                                            <div className=\"small\">\n                                                <strong>\n                                                    {prompt + ' ' + update}\n                                                </strong>\n                                            </div>\n                                        ); \n                                    }\n                                )\n                            }\n                        )\n                    },\n                    () => {\n                        this.props.notify(\n                            <div className=\"medium\">\n                                Something went wrong ð­. Let Harry know!\n                            </div>\n                        )\n                    }\n                )\n            }\n        )\n        .catch(err => alert(err))\n    }\n\n    render() {\n        var sub = queryString.parse(window.location.search).sub\n        var page = this.state.page\n        var disabled\n        var style\n        if (page == 1) {\n            disabled = this.state.img_files.length == 0\n            style = {opacity: disabled ? 0.5 : 1}\n            return (\n                <div className=\"add-rec-item\">\n                    <div className=\"medium\">\n                        1. Upload images of the product\n                    </div>\n                    <div className=\"small\">\n                        The user will receive the first image that you upload, exactly as you upload it\n                    </div>\n                    {/* <div className=\"demo\">\n                        {/* <div className=\"medium\">\n                            <div className=\"medium\">\n                                Bad image\n                            </div>\n                            <br/>\n                            <img src={bad_img} alt=\"\" />\n                            <div className=\"small\">\n                                <ul>\n                                    <li>Nobody deserved a pixelated image!</li>\n                                    <li>Which item is the image referring to?</li>\n                                </ul>\n                            </div>\n                        </div>\n                        <div className=\"medium\">\n                            <div className=\"medium\">\n                                a good image\n                            </div>\n                            <img src={good_img} alt=\"\" />\n                            <div className=\"small\">\n                                <ul>\n                                    <li>Just shows the product.</li>\n                                    <li>Image obviously refers to a particular item</li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div> */}\n                    <div style={{width: \"90vw\"}}>\n                        <div className=\"rec-img-container\">\n                            <div className=\"small\" style={{float: \"left\"}}>\n                                Images\n                            </div>\n                            <div>\n                                {this.getImgs()}\n                            </div>\n                        </div>\n                        <div className=\"btn rec-img-upload\">\n                            <input id=\"upload-rec-img\" type=\"file\" style={{display: \"none\"}} accept=\"image/*\" name=\"img\" onChange={this.setImgs} multiple />\n                            <label for=\"upload-rec-img\">Add images</label>\n                        </div>\n                    </div>\n                    <button className=\"btn\" onClick={this.next} disabled={disabled} style={style}>\n                        Next step!\n                    </button>\n                </div>\n            )\n        }\n        else if (page == 2) {\n            disabled = this.state.item.caption == ''\n            style = {opacity: disabled ? 0.5 : 1}\n            return (\n                <div className=\"add-rec-item\">\n                    <div className=\"medium\">\n                        2. Send a message to the user along with this item\n                    </div>\n                    <div className=\"add-item-input\">\n                        <div className=\"small\">\n                            Let them know why you made this specific recommendation.\n                            <br/>\n                            <br/> \n                            Examples: \n                            <br/>\n                            This will go perfectly with the red jacket you own. \n                            <br/> \n                            This is the best material to keep you cool on your holiday that you told me about. \n                            <br/> \n                            It's 20% off!\n                            <br/> \n                            ETC\n                        </div>\n                        <input id=\"caption\" className=\"add-item-input-field medium\" value={this.state.item.caption} onChange={this.handleTextChange}/>\n                    </div>\n                    <div style={{display: \"flex\", flexWrap: \"wrap\", justifyContent: \"center\"}}>\n                        <div className=\"btn\" onClick={this.previous} style={{minWidth: \"50px\", width: \"auto\"}}>\n                            Back\n                        </div>\n                        <button className=\"btn\" onClick={this.next} disabled={disabled} style={style}>\n                            Next step!\n                        </button>\n                    </div>\n                </div>\n            )\n        }\n        else if (page == 3) {\n            disabled = this.state.item.brand == ''\n            style = {opacity: disabled ? 0.5 : 1}\n            return (\n                <div className=\"add-rec-item\">\n                    <div className=\"medium\">\n                        3. The brand\n                    </div>\n                    <div className=\"add-item-input\">\n                        <div className=\"small\">\n                            What brand is the product from?\n                        </div>\n                        <input id=\"brand\" className=\"add-item-input-field medium\" value={this.state.item.brand} onChange={this.handleTextChange}/>\n                    </div>\n                    <div style={{display: \"flex\", flexWrap: \"wrap\", justifyContent: \"center\"}}>\n                        <div className=\"btn\" onClick={this.previous} style={{minWidth: \"50px\", width: \"auto\"}}>\n                            Back\n                        </div>\n                        <button className=\"btn\" onClick={this.next} disabled={disabled} style={style}>\n                            Next step!\n                        </button>\n                    </div>\n                </div>\n            )\n        }\n        else if (page == 4) {\n            disabled = this.state.item.url == ''\n            style = {opacity: disabled ? 0.5 : 1}\n            return (\n                <div className=\"add-rec-item\">\n                    <div className=\"medium\">\n                        4. The URL\n                    </div>\n                    <div className=\"add-item-input\">\n                        <div className=\"small\">\n                            Enter the web URL where you can buy the product from\n                        </div>\n                        <input id=\"url\" className=\"add-item-input-field medium\" value={this.state.item.url} onChange={this.handleTextChange}/>\n                    </div>\n                    <div style={{display: \"flex\", flexWrap: \"wrap\", justifyContent: \"center\"}}>\n                        <div className=\"btn\" onClick={this.previous} style={{minWidth: \"50px\", width: \"auto\"}}>\n                            Back\n                        </div>\n                        <button className=\"btn\" onClick={this.next} disabled={disabled} style={style}>\n                            Next step!\n                        </button>\n                    </div>\n                </div>\n            )\n        }\n        else if (page == 5) {\n            disabled = this.state.item.price == '' || !this.state.item.currency\n            style = {opacity: disabled ? 0.5 : 1}\n            return (\n                <div className=\"add-rec-item\">\n                    <div className=\"medium\">\n                        5. Price\n                    </div>\n                    <div className=\"add-item-input\">\n                        <div className=\"small\">\n                            What's the price?\n                        </div>\n                        <input id=\"price\" className=\"add-item-input-field medium text-response\" value={this.state.item.price} onChange={this.handleTextChange}/>\n                        <Dropdown onChange={this.handleOptionChange} id=\"currency\" value={this.state.currency} prompt='What currency?' name='currency' options={['$', 'Â£']}/>\n                    </div>\n                    <div style={{display: \"flex\", flexWrap: \"wrap\", justifyContent: \"center\"}}>\n                        <div className=\"btn\" onClick={this.previous} style={{minWidth: \"50px\", width: \"auto\"}}>\n                            Back\n                        </div>\n                        <button className=\"btn\" onClick={this.next} disabled={disabled} style={style}>\n                            Next step!\n                        </button>\n                    </div>\n                </div>\n            )\n        }\n        else if (page == 6) {\n            disabled = this.state.item.product_type.length <= 0\n            style = {opacity: disabled ? 0.5 : 1}\n            var allOptions = this.state.allTypes\n            var options = this.state.item.product_type\n            return (\n                <div className=\"add-rec-item\">\n                    <div className=\"add-item-input\">\n                        <div className=\"medium\">\n                            6. Product type\n                        </div>\n                        {/* <textarea id=\"tags\" className=\"add-item-input-field medium\" value={\n                                this.state.item.tags != null ? this.state.item.tags.join(',') : []\n                            } onChange={this.handleTextChange}/> */}\n                        <div className=\"panel\">\n                            <div className=\"\" style={{display: 'flex', flexWrap: 'wrap', justifyContent: 'center'}}>\n                                {\n                                    allOptions.map(\n                                        (item) => {\n                                        // console.log(item)\n                                            var opacity = options.includes(item) ? '1' : '0.5'\n                                            return <React.Fragment>\n                                                <label for={item} style={{opacity}} value={options.includes(item)}>\n                                                    <button className=\"btn text-btn\" id={item} name='product_type' onClick={this.handleArrayOptionChange}>\n                                                        <input className=\"radio_btn\" type=\"radio\" checked={options.includes(item)}/>\n                                                        {item}\n                                                    </button>\n                                                </label>\n                                            </React.Fragment>\n                                        }\n                                    )\n                                }\n                            </div>\n                            <div style={{marginTop: '30px'}}>\n                                <div><strong>Something else?</strong></div>\n                                <div className=\"searchbar\">\n                                    <input value={this.state.request} onChange={this.handleRequestChange} className=\"text-response\" placeholder='Enter a missing type...' style={{fontSize: '13px'}} />\n                                    <button onClick={this.submitRequest}>\n                                        {\n                                            this.state.request_loading ?\n                                            <Loading />\n                                            :\n                                            <img src={sendIcon} style={{height: '30px'}} />\n                                        }\n                                    </button>\n                                </div>\n                            </div>\n                            {/* <button className=\"btn\" onClick={this.handleSubmit}>\n                                Done\n                            </button> */}\n                        </div>\n                        {/* <Style title='6. Tag product'/> */}\n                    </div>\n                    <div style={{display: \"flex\", flexWrap: \"wrap\", justifyContent: \"center\"}}>\n                        <div className=\"btn\" onClick={this.previous} style={{minWidth: \"50px\", width: \"auto\"}}>\n                            Back\n                        </div>\n                        <button className=\"btn\" onClick={this.next} disabled={disabled} style={style}>\n                                Next!\n                        </button>\n                    </div>\n                </div>\n            )\n        }\n        else if (page == 7) {\n            disabled = this.state.item.tags.length <= 0\n            style = {opacity: disabled ? 0.5 : 1}\n            var allStyles = this.state.allStyles\n            var styles = this.state.item.tags\n            return (\n                <div className=\"add-rec-item\">\n                    <div className=\"add-item-input\">\n                        <div className=\"medium\">\n                            6. Tag the product\n                        </div>\n                        {/* <textarea id=\"tags\" className=\"add-item-input-field medium\" value={\n                                this.state.item.tags != null ? this.state.item.tags.join(',') : []\n                            } onChange={this.handleTextChange}/> */}\n                        <div className=\"panel\">\n                            <div className=\"medium\">\n                                {/* Your style */}\n                                {this.props.title}\n                            </div>\n                            <div className=\"\" style={{display: 'flex', flexWrap: 'wrap', justifyContent: 'center'}}>\n                                {\n                                    allStyles.map(\n                                        (item) => {\n                                        // console.log(item)\n                                            var opacity = styles.includes(item) ? '1' : '0.5'\n                                            return <React.Fragment>\n                                                <label for={item} style={{opacity}} value={styles.includes(item)}>\n                                                    <button className=\"btn text-btn\" id={item} name='tags' onClick={this.handleArrayOptionChange}>\n                                                        <input className=\"radio_btn\" type=\"radio\" checked={styles.includes(item)}/>\n                                                        {item}\n                                                    </button>\n                                                </label>\n                                            </React.Fragment>\n                                        }\n                                    )\n                                }\n                            </div>\n                            <div style={{marginTop: '30px'}}>\n                                <div><strong>Enter your own tag!</strong></div>\n                                <div className=\"searchbar\">\n                                    <input value={this.state.request} onChange={this.handleRequestChange} className=\"text-response\" placeholder='Enter a missing word...' style={{fontSize: '13px'}} />\n                                    <button onClick={this.submitRequest}>\n                                        {\n                                            this.state.request_loading ?\n                                            <Loading />\n                                            :\n                                            <img src={sendIcon} style={{height: '30px'}} />\n                                        }\n                                    </button>\n                                </div>\n                            </div>\n                            {/* <button className=\"btn\" onClick={this.handleSubmit}>\n                                Done\n                            </button> */}\n                        </div>\n                        {/* <Style title='6. Tag product'/> */}\n                    </div>\n                    <div style={{display: \"flex\", flexWrap: \"wrap\", justifyContent: \"center\"}}>\n                        <div className=\"btn\" onClick={this.previous} style={{minWidth: \"50px\", width: \"auto\"}}>\n                            Back\n                        </div>\n                        <button className=\"btn\" onClick={this.recommendItem} disabled={disabled} style={style}>\n                            {\n                                this.state.loading ?\n                                <Loading /> :\n                                'Recommend!'\n                            }\n                        </button>\n                    </div>\n                </div>\n            )\n        }\n    }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        openModal: (content) => {\n            console.log('content:', content)\n            dispatch({\n                type: \"OPEN_MODAL\",\n                content: content\n            })\n        },\n        closeModal: () => {\n            dispatch({\n                type: \"CLOSE_MODAL\"\n            })\n        },\n        closeSlideUp: () => {\n            dispatch({\n                type: \"CLOSE_SLIDEUP\"\n            })\n        },\n        notify: (content) => {\n            dispatch({\n                type: \"NOTIFY\",\n                content\n            })\n        }\n    }\n}\n\nexport default AddRecItem = connect(null, mapDispatchToProps)(AddRecItem)\n\n\n\n\n\nclass MakeRecommendations extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            recs: []\n        }\n    }\n\n    componentDidMount = () => {\n        console.log('getting recommendations')\n        this.getRecs()\n    }\n\n    getRecs = () => {\n        console.log('getting latest recommendations')\n        var params = queryString.parse(window.location.search)\n        console.log(params)\n        var req_id = params.req_id\n        /*\n        makeGetRequest(`recommendations?req_id=${req_id}`, \n            (recs) =>{\n                console.log('got recommendations')\n                recs = recs.body\n                recs = JSON.parse(recs)\n                console.log('recommendations:', recs)\n                recs = recs.map(\n                    (rec) => {\n                        return <RecommendationItem src={rec.img_urls[0]} id={rec['Item ID']}/>//<img src={rec.img_urls[0]} alt=\"\" className=\"rec-img-thumb\"/>\n                    }\n                )\n                this.setState({recs: recs},\n                    console.log(this.state)    \n                )\n            }\n        )\n        */\n    }\n\n    makeRecommendations = () => {\n        var req_id = queryString.parse(window.location.search).req_id\n        var sub = queryString.parse(window.location.search).sub\n        makePostRequest(`update-order-status?sub=${sub}&req_id=${req_id}`, {nextStatus: 'recommendations_made'}, () => {console.log('order updated')})\n\n        this.props.refresh()\n    }\n\n    render () {\n        console.log(this.props)\n        return (\n                <div className=\"medium slideUp-content\" style={{position: \"absolute\", top: \"8vh\"}}>\n                    Make recommendations\n                    <div className='recommendations-to-be-made' style={{padding: \"10px\"}}>\n                        {this.state.recs}\n                    </div>\n                    <div className=\"btn small\" onClick={() => this.props.openModal(<AddRecItem onRecommend={this.props.refresh} closeModal={this.props.closeModal} />)}>\n                        Recommend a new item!\n                    </div>\n                    <div className=\"btn small\" onClick={this.clo}>\n                        Send these recommendations\n                    </div>\n                </div>\n        )\n    }\n}\n\nclass RecommendationItem extends Component {\n\n    render () {\n        return (\n            <div className=\"recommendation-item\" id={this.props.id}>\n                <img className=\"rec-img-thumb\" src={this.props.src} alt=''  />\n            </div>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}